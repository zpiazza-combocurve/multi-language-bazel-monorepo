import pytest
import mongomock
from pymongo import UpdateOne
from bson import ObjectId
from math import isclose
import json
import os
from datetime import datetime

from combocurve.services.proximity_forecast.proximity_data_model_helpers import (create_settings_object,
                                                                                 create_well_forecast_pairs)
from combocurve.services.proximity_forecast.proximity_data_models import (
    MultiplierPair, NormalizationBase, NormalizationBaseAxis, NormalizationHeaders, ProximityCriteriaSettings,
    ProximitySettings, ProximityFitSettings, ProximityNormalizationSettings, ProximityDocument, BestFitQPeakDict,
    BuildupDict, ProximityFitsContainer)

from combocurve.services.proximity_forecast.proximity_forecast_service import ProximityForecastService
from combocurve.services.forecast.mass_modify_well_life_v2 import MassModifyWellLifeService
from combocurve.services.type_curve.type_curve_service import TypeCurveService
from combocurve.services.production.production_service import ProductionService
from combocurve.services.type_curve.tc_normalization_service import TypeCurveNormalizationService
from combocurve.dal.mock_client import MockDAL


def _create_db():
    collections = {}
    file_dir = os.path.dirname(os.path.realpath('__file__'))

    wells_collection = mongomock.MongoClient().db.collection
    data_path = os.path.join(file_dir, 'combocurve/services/forecast/db_test_data/wells.json')

    with open(data_path, 'r') as f:
        prod_data = json.load(f)
    for doc in prod_data:
        doc['_id'] = ObjectId(doc['_id'])
        for key in ['first_prod_date_monthly_calc', 'first_prod_date_daily_calc', 'first_prod_date']:
            if not doc[key]:
                continue
            try:
                doc[key] = datetime.strptime(doc[key], '%Y-%m-%d %H:%M:%S')
            except Exception:
                doc[key] = datetime.strptime(doc[key], '%Y-%m-%d %H:%M:%S.%f')
        wells_collection.insert_one(doc)
    collections['wells'] = wells_collection

    forecasts_collection = mongomock.MongoClient().db.collection
    data_path = os.path.join(file_dir, 'combocurve/services/forecast/db_test_data/forecasts.json')
    with open(data_path, 'r') as f:
        forecasts_data = json.load(f)
    for doc in forecasts_data:
        for key in ['_id', 'project']:
            doc[key] = ObjectId(doc[key])
        doc['wells'] = [ObjectId(well) for well in doc['wells']]
        forecasts_collection.insert_one(doc)
    collections['forecasts'] = forecasts_collection

    deterministic_forecast_datas_collection = mongomock.MongoClient().db.collection
    data_path = os.path.join(
        file_dir, 'combocurve/services/forecast/db_test_data/deterministic_forecast_datas_collection_proximity.json')
    with open(data_path, 'r') as f:
        deterministic_forecast_datas = json.load(f)
    for doc in deterministic_forecast_datas:
        for key in ['_id', 'forecast', 'project', 'well']:
            doc[key] = ObjectId(doc[key])
        deterministic_forecast_datas_collection.insert_one(doc)
    collections['deterministic_forecast_datas_collection'] = deterministic_forecast_datas_collection

    monthly_productions_collection = mongomock.MongoClient().db.collection
    data_path = os.path.join(file_dir, 'combocurve/services/forecast/db_test_data/monthly_productions_proximity.json')
    with open(data_path, 'r') as f:
        monthly_productions_data = json.load(f)
    for doc in monthly_productions_data:
        doc['_id'] = ObjectId(doc['_id'])
        monthly_productions_collection.insert_one(doc)
    collections['monthly_productions'] = monthly_productions_collection

    collections |= {
        'proximity_forecast_datas_collection': mongomock.MongoClient().db.collection,
        'daily_productions': mongomock.MongoClient().db.collection,
        'forecast_datas_collecton': mongomock.MongoClient().db.collection,
    }
    return collections


class MockContext():
    def __init__(self):
        collections = _create_db()
        db = {}
        self.deterministic_forecast_datas_collection = db['deterministic-forecast-datas'] = collections[
            'deterministic_forecast_datas_collection']
        self.proximity_forecast_datas_collection = db['proximity-forecast-datas'] = collections[
            'proximity_forecast_datas_collection']
        self.forecasts_collection = db['forecasts'] = collections['forecasts']
        self.wells_collection = db['wells'] = collections['wells']

        self.forecast_datas_collection = db['forecast-datas'] = collections['forecast_datas_collecton']
        self.monthly_productions_collection = db['monthly-productions'] = collections['monthly_productions']
        self.daily_productions_collection = db['daily-productions'] = collections['daily_productions']

        self.db = db
        self.dal = MockDAL(db['monthly-productions'], db['daily-productions'])
        self.tc_normalization_service = TypeCurveNormalizationService(self)
        self.production_service = ProductionService(self)
        self.mass_modify_well_life_service = MassModifyWellLifeService(self)
        self.type_curve_service = TypeCurveService(self)


@pytest.mark.unittest
@pytest.mark.python_apis
def test_create_proximity_objects_and_documents():
    neighbor_params = {
        'phase': 'oil',
        'phase_type': 'rate',
        'base_phase': None,
        'proximity_forecast_id': '5fb4359d511e670012ca42bc',
        'neighbor_dict': {
            'wellCountRange': {
                'start': 1,
                'end': 10
            },
            'selectedForecasts': ['5fb4359d511e670012ca42bc'],
            'searchRadius': 10000,
            'selectedFields': []
        },
        'target_well_id': '5f859599e1ee918fd31a9e34',
        'num_month': 720
    }
    norm_params = {
        'oil': {
            'pValues': [0.0, 0.98],
            'xChain': {
                'label': None,
                'start_feature': 'perf_lateral_length',
                'op_chain': [],
                'operator': None,
                'default_min': None,
                'default_max': None,
                'unit': None
            },
            'yChain': {
                'label': None,
                'start_feature': 'oil_eur',
                'op_chain': [],
                'operator': None,
                'default_min': None,
                'default_max': None,
                'unit': None
            },
            'normalizationType': 'linear',
            'target': {
                'perf_lateral_length': 4149.0,
            }
        }
    }
    fit_params = {
        'addSeries': 'average',
        'addSeriesFitRange': ['2022-09-26T23:05:33.587Z', '2022-09-26T23:05:33.587Z'],
        'applySeries': 'average',
        'b': [-2, -0.001],
        'b0': [-10, -0.001],
        'b2': [0.001, 2],
        'basePhase': 'gas',
        'best_fit_q_peak': {
            'method': 'P50',
            'range': [1, 99]
        },
        'buildup': {
            'apply_ratio': False,
            'apply': True,
            'buildup_ratio': 0.1,
            'days': 0
        },
        'D_lim_eff': 0.08,
        'D1_eff': [1e-05, 0.99],
        'fit_complexity': 'complex',
        'minus_t_decline_t_0': [1, 300],
        'minus_t_elf_t_peak': [1, 5000],
        'minus_t_peak_t0': [0, 1000],
        'p1_range': [-10000, 12500],
        'phaseType': 'rate',
        'q_final': 0.8,
        'q_peak': [0, 10000],
        'TC_model': 'segment_arps_4_wp_free_b1',
        'well_life': 60,
        'b1': [0.001, 2],
        'base_phase': None
    }

    settings_document = create_settings_object(neighbor_params, norm_params, fit_params)

    res = ProximitySettings(
        neighbor_criteria_settings=ProximityCriteriaSettings(search_radius=10000.0, criteria=[]),
        normalization_settings=ProximityNormalizationSettings(
            range_start=0.0,
            range_end=0.98,
            base=NormalizationBase(
                x=NormalizationBaseAxis(start_feature='perf_lateral_length', op_chain=[]),
                y=NormalizationBaseAxis(start_feature='oil_eur', op_chain=[]),
            ),
            type='linear',
            headers=NormalizationHeaders(perf_lateral_length=4149.0, ),
        ),
        fit_settings=ProximityFitSettings(add_series=None,
                                          add_series_fit_range=None,
                                          apply_series=None,
                                          b0=[-10.0, -0.001],
                                          b=[-2.0, -0.001],
                                          b2=[0.001, 2.0],
                                          best_fit_q_peak=BestFitQPeakDict(method='P50', range=[1.0, 99.0]),
                                          buildup=BuildupDict(apply_ratio=False,
                                                              apply=True,
                                                              buildup_ratio=0.1,
                                                              days=0.0),
                                          D_lim_eff=0.08,
                                          D1_eff=[1e-05, 0.99],
                                          fit_complexity='complex',
                                          minus_t_decline_t_0=[1.0, 300.0],
                                          minus_t_elf_t_peak=[1.0, 5000.0],
                                          minus_t_peak_t0=[0.0, 1000.0],
                                          p1_range=[-10000.0, 12500.0],
                                          q_final=0.8,
                                          q_peak=[0.0, 10000.0],
                                          TC_model='segment_arps_4_wp_free_b1',
                                          well_life=60.0),
    )

    assert settings_document == res

    wellForecastMap = {
        '5f859598e1ee918fd31a9e1b': '5fb4359d511e670012ca42bc',
        '5f859599e1ee918fd31a9e2f': '5fb4359d511e670012ca42bc',
        '5f859599e1ee918fd31a9e3b': '5fb4359d511e670012ca42bc',
        '5f859599e1ee918fd31a9e24': '5fb4359d511e670012ca42bc',
        '5f859599e1ee918fd31a9e38': '5fb4359d511e670012ca42bc',
        '5f859599e1ee918fd31a9e3d': '5fb4359d511e670012ca42bc',
        '5f859599e1ee918fd31a9e42': '5fb4359d511e670012ca42bc',
        '5f859599e1ee918fd31a9e50': '5fb4359d511e670012ca42bc'
    }
    proximity_fits_to_db = {
        'fitted': {
            'P10': [{
                'test': 'test'
            }],
            'P50': [{
                'test': 'test'
            }],
            'P90': [{
                'test': 'test'
            }],
            'average': [{
                'test': 'test'
            }]
        },
        'unfitted': {
            'P10': [{
                'test': 'test'
            }],
            'P50': [{
                'test': 'test'
            }],
            'P90': [{
                'test': 'test'
            }],
            'average': [{
                'test': 'test'
            }]
        }
    }
    new_proximity_document = ProximityDocument(
        project=ObjectId('5fb4358c511e670012ca42b3'),
        forecast=ObjectId('5fb4359d511e670012ca42bc'),
        well=ObjectId('5f859599e1ee918fd31a9e34'),
        phase='oil',
        resolution='monthly',
        phase_type='rate',
        base_phase=None,
        fits=ProximityFitsContainer.parse_obj(proximity_fits_to_db),
        normalization_multipliers=[MultiplierPair(qPeak=1.0, eur=1.0) for _ in range(8)],
        wells=create_well_forecast_pairs(wellForecastMap),
        settings=settings_document)
    proximity_phase_update = UpdateOne(
        filter={
            'forecast': new_proximity_document.forecast,
            'well': new_proximity_document.well,
            'phase': new_proximity_document.phase,
        },
        update={'$set': new_proximity_document.dict()},
        upsert=True,
    )

    res_proximity_document = UpdateOne(
        {
            'forecast': ObjectId('5fb4359d511e670012ca42bc'),
            'well': ObjectId('5f859599e1ee918fd31a9e34'),
            'phase': 'oil'
        }, {
            '$set': {
                'project':
                ObjectId('5fb4358c511e670012ca42b3'),
                'forecast':
                ObjectId('5fb4359d511e670012ca42bc'),
                'well':
                ObjectId('5f859599e1ee918fd31a9e34'),
                'phase':
                'oil',
                'resolution':
                'monthly',
                'phase_type':
                'rate',
                'base_phase':
                None,
                'fits': {
                    'fitted': {
                        'P10': [{
                            'test': 'test'
                        }],
                        'P50': [{
                            'test': 'test'
                        }],
                        'P90': [{
                            'test': 'test'
                        }],
                        'average': [{
                            'test': 'test'
                        }]
                    },
                    'unfitted': {
                        'P10': [{
                            'test': 'test'
                        }],
                        'P50': [{
                            'test': 'test'
                        }],
                        'P90': [{
                            'test': 'test'
                        }],
                        'average': [{
                            'test': 'test'
                        }]
                    }
                },
                'normalization_multipliers': [{
                    'qPeak': 1.0,
                    'eur': 1.0
                } for _ in range(8)],
                'settings': {
                    'neighbor_criteria_settings': {
                        'search_radius': 10000.0,
                        'criteria': []
                    },
                    'normalization_settings': {
                        'range_start': 0.0,
                        'range_end': 0.98,
                        'diverged': False,
                        'key': 'normalize',
                        'name': 'Normalize',
                        'base': {
                            'x': {
                                'label': None,
                                'start_feature': 'perf_lateral_length',
                                'op_chain': [],
                                'operator': None,
                                'default_min': None,
                                'default_max': None,
                                'unit': None
                            },
                            'y': {
                                'label': None,
                                'start_feature': 'oil_eur',
                                'op_chain': [],
                                'operator': None,
                                'default_min': None,
                                'default_max': None,
                                'unit': None
                            }
                        },
                        'type': 'linear',
                        'headers': {
                            'eur': None,
                            'first_fluid_volume': None,
                            'first_prop_weight': None,
                            'horizontal_spacing': None,
                            'perf_lateral_length': 4149.0,
                            'vertical_spacing': None,
                            'well_name': None
                        }
                    },
                    'fit_settings': {
                        'add_series': None,
                        'add_series_fit_range': None,
                        'apply_series': None,
                        'b0': [-10.0, -0.001],
                        'b': [-2.0, -0.001],
                        'b2': [0.001, 2.0],
                        'best_fit_q_peak': {
                            'method': 'P50',
                            'range': [1.0, 99.0]
                        },
                        'buildup': {
                            'apply_ratio': False,
                            'apply': True,
                            'buildup_ratio': 0.1,
                            'days': 0.0
                        },
                        'D_lim_eff': 0.08,
                        'D1_eff': [1e-05, 0.99],
                        'fit_complexity': 'complex',
                        'minus_t_decline_t_0': [1.0, 300.0],
                        'minus_t_elf_t_peak': [1.0, 5000.0],
                        'minus_t_peak_t0': [0.0, 1000.0],
                        'p1_range': [-10000.0, 12500.0],
                        'q_final': 0.8,
                        'q_peak': [0.0, 10000.0],
                        'TC_model': 'segment_arps_4_wp_free_b1',
                        'well_life': 60.0
                    }
                },
                'wells': [{
                    'well': ObjectId('5f859598e1ee918fd31a9e1b'),
                    'forecast': ObjectId('5fb4359d511e670012ca42bc')
                }, {
                    'well': ObjectId('5f859599e1ee918fd31a9e2f'),
                    'forecast': ObjectId('5fb4359d511e670012ca42bc')
                }, {
                    'well': ObjectId('5f859599e1ee918fd31a9e3b'),
                    'forecast': ObjectId('5fb4359d511e670012ca42bc')
                }, {
                    'well': ObjectId('5f859599e1ee918fd31a9e24'),
                    'forecast': ObjectId('5fb4359d511e670012ca42bc')
                }, {
                    'well': ObjectId('5f859599e1ee918fd31a9e38'),
                    'forecast': ObjectId('5fb4359d511e670012ca42bc')
                }, {
                    'well': ObjectId('5f859599e1ee918fd31a9e3d'),
                    'forecast': ObjectId('5fb4359d511e670012ca42bc')
                }, {
                    'well': ObjectId('5f859599e1ee918fd31a9e42'),
                    'forecast': ObjectId('5fb4359d511e670012ca42bc')
                }, {
                    'well': ObjectId('5f859599e1ee918fd31a9e50'),
                    'forecast': ObjectId('5fb4359d511e670012ca42bc')
                }]
            }
        }, True, None, None, None)

    assert res_proximity_document == proximity_phase_update


initial_fit_params = {
    'best_fit_method': 'average',
    'best_fit_q_peak': {
        'method': 'P50',
        'range': [30, 70]
    },
    'best_fit_range': [40860, 62927],
    'fit_para': {
        'data': 'noalign',
        'fit_complexity': 'complex',
        'p1_range': [0, 10943],
        'TC_percentile': [10, 50, 90]
    },
    'init_data': {
        'background_data': {
            'idx': [
                0, 30, 61, 91, 122, 152, 183, 213, 244, 274, 304, 335, 365, 396, 426, 457, 487, 517, 548, 578, 609, 639,
                670, 700, 731, 761, 791, 822, 852, 883, 913, 944, 974, 1004, 1035, 1065, 1096, 1126, 1157, 1187, 1218,
                1248, 1278, 1309, 1339, 1370, 1400, 1431, 1461, 1491, 1522, 1552, 1583, 1613, 1644, 1674, 1705, 1735,
                1765, 1796, 1826, 1857, 1887, 1918, 1948, 1978, 2009, 2039, 2070, 2100, 2131, 2161, 2192, 2222, 2252,
                2283, 2313, 2344, 2374, 2405, 2435, 2465, 2496, 2526, 2557, 2587, 2618, 2648, 2679, 2709, 2739, 2770,
                2800, 2831, 2861, 2892, 2922, 2952, 2983, 3013, 3044, 3074, 3105, 3135, 3166, 3196, 3226, 3257, 3287,
                3318, 3348, 3379, 3409, 3439, 3470, 3500, 3531, 3561, 3592, 3622, 3653, 3683, 3713, 3744, 3774, 3805,
                3835, 3866, 3896, 3926, 3957, 3987, 4018, 4048, 4079, 4109, 4140, 4170, 4200, 4231, 4261, 4292, 4322,
                4353, 4383, 4413, 4444, 4474, 4505, 4535, 4566, 4596, 4627, 4657, 4687, 4718, 4748, 4779, 4809, 4840,
                4870, 4900, 4931, 4961, 4992, 5022, 5053, 5083, 5114, 5144, 5174, 5205, 5235, 5266, 5296, 5327, 5357,
                5387, 5418, 5448, 5479, 5509, 5540, 5570, 5601, 5631, 5661, 5692, 5722, 5753, 5783, 5814, 5844, 5874,
                5905, 5935, 5966, 5996, 6027, 6057, 6088, 6118, 6148, 6179, 6209, 6240, 6270, 6301, 6331, 6361, 6392,
                6422, 6453, 6483, 6514, 6544, 6575, 6605, 6635, 6666, 6696, 6727, 6757, 6788, 6818, 6848, 6879, 6909,
                6940, 6970, 7001, 7031, 7062, 7092, 7122, 7153, 7183, 7214, 7244, 7275, 7305, 7335, 7366, 7396, 7427,
                7457, 7488, 7518, 7549, 7579, 7609, 7640, 7670, 7701, 7731, 7762, 7792, 7822, 7853, 7883, 7914, 7944,
                7975, 8005, 8036, 8066, 8096, 8127, 8157, 8188, 8218, 8249, 8279, 8309, 8340, 8370, 8401, 8431, 8462,
                8492, 8523, 8553, 8583, 8614, 8644, 8675, 8705, 8736, 8766, 8796, 8827, 8857, 8888, 8918, 8949, 8979,
                9010, 9040, 9070, 9101, 9131, 9162, 9192, 9223, 9253, 9283, 9314, 9344, 9375, 9405, 9436, 9466, 9497,
                9527, 9557, 9588, 9618, 9649, 9679, 9710, 9740, 9770, 9801, 9831, 9862, 9892, 9923, 9953, 9984, 10014,
                10044, 10075, 10105, 10136, 10166, 10197, 10227, 10257, 10288, 10318, 10349, 10379, 10410, 10440, 10471,
                10501, 10531, 10562, 10592, 10623, 10653, 10684, 10714, 10744, 10775, 10805, 10836, 10866, 10897, 10927,
                10958, 10988, 11018, 11049, 11079, 11110, 11140, 11171, 11201, 11231, 11262, 11292, 11323, 11353, 11384,
                11414, 11445, 11475, 11505, 11536, 11566, 11597, 11627, 11658, 11688, 11718, 11749, 11779, 11810, 11840,
                11871, 11901, 11932, 11962, 11992, 12023, 12053, 12084, 12114, 12145, 12175, 12205, 12236, 12266, 12297,
                12327, 12358, 12388, 12419, 12449, 12479, 12510, 12540, 12571, 12601, 12632, 12662, 12692, 12723, 12753,
                12784, 12814, 12845, 12875, 12906, 12936, 12966, 12997, 13027, 13058, 13088, 13119, 13149, 13179, 13210,
                13240, 13271, 13301, 13332, 13362, 13393, 13423, 13453, 13484, 13514, 13545, 13575, 13606, 13636, 13666,
                13697, 13727, 13758, 13788, 13819, 13849, 13880, 13910, 13940, 13971, 14001, 14032, 14062, 14093, 14123,
                14153, 14184, 14214, 14245, 14275, 14306, 14336, 14367, 14397, 14427, 14458, 14488, 14519, 14549, 14580,
                14610, 14640, 14671, 14701, 14732, 14762, 14793, 14823, 14854, 14884, 14914, 14945, 14975, 15006, 15036,
                15067, 15097, 15127, 15158, 15188, 15219, 15249, 15280, 15310, 15341, 15371, 15401, 15432, 15462, 15493,
                15523, 15554, 15584, 15614, 15645, 15675, 15706, 15736, 15767, 15797, 15828, 15858, 15888, 15919, 15949,
                15980, 16010, 16041, 16071, 16101, 16132, 16162, 16193, 16223, 16254, 16284, 16315, 16345, 16375, 16406,
                16436, 16467, 16497, 16528, 16558, 16588, 16619, 16649, 16680, 16710, 16741, 16771, 16802, 16832, 16862,
                16893, 16923, 16954, 16984, 17015, 17045, 17075, 17106, 17136, 17167, 17197, 17228, 17258, 17289, 17319,
                17349, 17380, 17410, 17441, 17471, 17502, 17532, 17562, 17593, 17623, 17654, 17684, 17715, 17745, 17776,
                17806, 17836, 17867, 17897, 17928, 17958, 17989, 18019, 18049, 18080, 18110, 18141, 18171, 18202, 18232,
                18263, 18293, 18323, 18354, 18384, 18415, 18445, 18476, 18506, 18536, 18567, 18597, 18628, 18658, 18689,
                18719, 18750, 18780, 18810, 18841, 18871, 18902, 18932, 18963, 18993, 19023, 19054, 19084, 19115, 19145,
                19176, 19206, 19237, 19267, 19297, 19328, 19358, 19389, 19419, 19450, 19480, 19510, 19541, 19571, 19602,
                19632, 19663, 19693, 19724, 19754, 19784, 19815, 19845, 19876, 19906, 19937, 19967, 19997, 20028, 20058,
                20089, 20119, 20150, 20180, 20211, 20241, 20271, 20302, 20332, 20363, 20393, 20424, 20454, 20484, 20515,
                20545, 20576, 20606, 20637, 20667, 20698, 20728, 20758, 20789, 20819, 20850, 20880, 20911, 20941, 20971,
                21002, 21032, 21063, 21093, 21124, 21154, 21185, 21215, 21245, 21276, 21306, 21337, 21367, 21398, 21428,
                21458, 21489, 21519, 21550, 21580, 21611, 21641, 21672, 21702, 21732, 21763, 21793, 21824, 21854, 21885
            ],
            'data': [
                [
                    149.42094455852157, 392.4435318275154, 209.93839835728951, 160.9199178644764, 0, 1.1498973305954825,
                    0, 83.94250513347022, 76.84599589322382, 61.96303901437371, 37.58521560574949, 31.37577002053388,
                    16.525667351129364, 12.517453798767967, 3.2854209445585214, 30.915811088295687, 19.351129363449694,
                    24.93634496919918, 0, 17.7741273100616, 50.8911704312115, 0, 44.58316221765914, 40.24640657084189,
                    45.79876796714579, 34.82546201232033, 48.85420944558521, 24.706365503080082, 30.652977412731005,
                    13.930184804928132, 2.3655030800821355, 38.078028747433265, 39.29363449691992, 25.3305954825462,
                    32.19712525667351, 25.363449691991786, 35.383983572895275, 28.254620123203285, 29.1088295687885,
                    10.57905544147844, 26.874743326488705, 32.75564681724846, 32.2299794661191, 27.236139630390145,
                    23.49075975359343, 19.02258726899384, 20.008213552361397, 12.91170431211499, 26.874743326488705,
                    21.026694045174537, 22.80082135523614, 15.474332648870636, 12.813141683778234, 15.24435318275154,
                    11.203285420944558, 8.31211498973306, 11.039014373716633, 22.012320328542096, 18.529774127310063,
                    13.010266940451745, 6.669404517453799, 18.792607802874745, 15.014373716632443, 6.93223819301848,
                    9.626283367556468, 10.611909650924025, 9.19917864476386, 5.28952772073922, 0, 11.433264887063656,
                    15.671457905544148, 18.20123203285421, 20.53388090349076, 12.02464065708419, 14.685831622176591, 0,
                    0, 0, 0.03285420944558522, 0.03285420944558522, 0, 0, 11.893223819301848, 2.2340862422997945, 0,
                    0.03285420944558522, 0.5256673511293635, 14.35728952772074, 0, 12.28747433264887, 4.698151950718686,
                    2.4640657084188913, 0.75564681724846, 0.5256673511293635, 12.2217659137577, 5.815195071868583,
                    16.164271047227928, 1.8726899383983573, 0, 0, 0, 0, 5.9137577002053385, 4.566735112936345, 0, 0, 0,
                    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 867.2967991453229, 707.4891792270868,
                    607.7036650575917, 544.0613855139937, 490.9722507716953, 450.9228594694527, 417.54453396288017,
                    390.8270697317599, 367.5210072271569, 347.57487629896, 330.7899024527637, 315.53528033061184,
                    302.4288036850272, 290.30406841503566, 279.38998249688206, 270.1118115885382, 261.0488355507929,
                    253.00774695191765, 245.35522662877696, 238.5076639190921, 231.9408347964583, 225.83323401611997,
                    220.3127846310547, 214.96976030798288, 210.1144293390513, 205.3918686403364, 200.94107782396054,
                    197.1341507158265, 193.1353498889313, 189.46415669396458, 185.85917106882093, 182.5387591736093,
                    179.26827323922498, 176.14891260690058, 173.26368004345042, 170.41053873446796, 167.7651621366136,
                    165.14322136039638, 162.6273547242293, 160.44046747102078, 158.10820016484413, 155.93493101371544,
                    153.7706521291361, 151.75048115204723, 149.73539260770522, 147.7898338917475, 145.96964333767022,
                    144.15003562648857, 142.4453488306693, 140.73896912596723, 139.08581620367764, 137.6361924694413,
                    136.07718616402033, 134.612320515464, 133.1418269023072, 131.7586826096452, 130.36882261487744,
                    129.01722734499913, 127.74408055523743, 126.46296567588661, 125.25514646027013, 124.0387334564758,
                    122.85319449697442, 121.77098203065621, 120.64170303177067, 119.57494253602911, 118.49854820529572,
                    117.48102574253868, 116.45360962268914, 115.44971340474275, 114.49978295932023, 113.53969210848118,
                    112.63065590584486, 111.711349543753, 109.47395368196764, 108.67487582426612, 107.79758464625121,
                    106.95593203027704, 106.09373655642588, 105.2665562262185, 104.41917586215119, 103.57921875564459,
                    102.77335875327316, 101.94780412217128, 101.15575226499767, 100.3443333403352, 99.53999760631527,
                    98.81953335773808, 98.02849443968562, 97.26953473025983, 96.49199374711247, 95.74597556060012,
                    94.98168370805264, 94.22403125329473, 93.49708206201791, 92.75231277545575, 92.03771608640649,
                    91.30559332239515, 90.57980828972937, 89.92965859055835, 89.21577233868734, 88.53078725621066,
                    87.82898160747315, 87.15558004102442, 86.46563415715886, 85.7816321279209, 85.12530188044465,
                    84.45283472072099, 83.80756506708627, 83.1464226429551, 82.49095620345464, 81.88286976019693,
                    81.23823992246675, 80.61966360357835, 79.98585259124344, 79.37765072423298, 78.75446239065255,
                    78.13659852524475, 77.54368903240095, 76.93615921711493, 76.35315962613991, 75.75577714502046,
                    75.16348111463851, 74.63283701650481, 74.05009269269247, 73.49086181898326, 72.91781805921543,
                    72.36789000645096, 71.80437236841522, 71.24563010497003, 70.70941737118676, 70.15994448682521,
                    69.63262134517906, 69.09225171769528, 68.55644569965831, 68.07637973304622, 67.54914452934537,
                    67.04314839647779, 66.52461884587416, 66.0269720333993, 65.51699284749651, 65.0113003733986,
                    64.52596538917554, 64.0285946823145, 63.55124108992031, 63.06204420971872, 62.576945453537235,
                    62.14228328630025, 61.664881954537165, 61.20668135557012, 60.73709966698008, 60.28639918920995,
                    59.82449877580064, 59.36644977920545, 58.9268109175342, 58.47623946711127, 58.043772824305286,
                    57.60054704774471, 57.161004583499206, 56.753124909802736, 56.3206177211564, 55.90547808977958,
                    55.479998733828076, 55.07160025126461, 54.653025360858145, 54.23791276634823, 53.83945830502847,
                    53.43106849884762, 53.039062776729466, 52.637278137864556, 52.23880585744447, 51.881717893099335,
                    51.48946845782723, 51.112945471963776, 50.727019458529895, 50.35656237243987, 49.976849653143994,
                    49.6002529670167, 49.23874540090728, 48.86819979816085, 48.51249705375885, 48.14789749643879,
                    47.78628007525096, 47.46219916025231, 47.106184778157484, 46.76442215449176, 46.41410214812892,
                    46.07780237461969, 45.73307834655615, 45.391161054060404, 45.062922467267434, 44.72645619323049,
                    44.403447144094834, 44.072338003742026, 43.743915919561246, 43.44956658714266, 43.12619363533859,
                    42.81574615995648, 42.49750533759819, 42.191981662083734, 41.87878497477872, 41.56811849878123,
                    41.269861805380806, 40.96410980667424, 40.670568229501136, 40.36964671847091, 40.071148353302405,
                    39.794082949833076, 39.50021479723927, 39.21807520730247, 38.92883489939341, 38.65113559405576,
                    38.366444394918375, 38.08403532611928, 37.8128904905385, 37.53491449391891, 37.26802318269299,
                    36.99440507854943, 36.72297326980256, 36.479672511023246, 36.21234968757454, 35.95568027098773,
                    35.692535074341954, 35.43987423617779, 35.1808361328469, 34.923858621155446, 34.67711597263742,
                    34.424141587477116, 34.18124018358169, 33.932201553267625, 33.68513763297322, 33.46366634658768,
                    33.22031410949902, 32.98664591849776, 32.74706785326298, 32.517021347374225, 32.28115421508956,
                    32.04714909726706, 31.822450448838765, 31.59206303313586, 31.37083601559643, 31.14400587678007,
                    30.918960725829916, 30.717215739337174, 30.49552598629982, 30.282645602211797, 30.064368168532432,
                    29.854762446820615, 29.639840586636357, 29.426602596730365, 29.22183308598666, 29.011866996786743,
                    28.81023747790064, 28.603489049634764, 28.39835534998864, 28.20790582882756, 28.0058587901341,
                    27.811829199244343, 27.612868829049155, 27.421801574381636, 27.22587692645236, 27.031475788585595,
                    26.84478417578961, 26.653343626274793, 26.469493422521847, 26.28096474851025, 26.093897488359392,
                    25.926179438825127, 25.74185983634269, 25.564844046710714, 25.38331940479932, 25.208986160429788,
                    25.030210689320118, 24.852815048575543, 24.6824447851201, 24.50773077456509, 24.339934350617764,
                    24.167858173177116, 23.997105996284766, 23.844007067696655, 23.675744418328545, 23.514133409370487,
                    23.348314177208124, 23.188957404582094, 23.02543127990929, 22.863058324522367, 22.707013517205482,
                    22.54688601088526, 22.39299914093004, 22.235086031451733, 22.078286508857794, 21.937611752176487,
                    21.78290998737437, 21.634237401951488, 21.481675001630144, 21.335058403408986, 21.184605782383088,
                    21.03521413765008, 20.89164472141593, 20.744319007726915, 20.602735007173116, 20.45744665485082,
                    20.313182860933665, 20.1791475474476, 20.036846289997243, 19.900090927955098, 19.7597575488683,
                    19.624893371225262, 19.486500656791307, 19.34908387343867, 19.217022623279913, 19.081506171095064,
                    18.951271190651052, 18.817628790030742, 18.684928821770978, 18.565875297641934, 18.434950668922664,
                    18.309128555179342, 18.18001447788266, 18.055932353087634, 17.928603789170772, 17.802173133092293,
                    17.680669848757162, 17.555987597134447, 17.436164576829498, 17.313206551047678, 17.191115612522207,
                    17.08158011913591, 16.961122586206105, 16.845359634973818, 16.726567904420094, 16.612405834382486,
                    16.49525686989081, 16.37893402775722, 16.26714462635085, 16.15243040812069, 16.042186937848335,
                    15.929059097926363, 15.816729023808705, 15.715950618472503, 15.60512336326869, 15.498615369726739,
                    15.389320740175824, 15.28428564139104, 15.176502442874538, 15.069479320304989, 14.966627201243536,
                    14.861084097129751, 14.759654315884374, 14.655570763110678, 14.552221196765538, 14.45619924179273,
                    14.354255622756146, 14.256285044146907, 14.155751199316109, 14.059135451896447, 13.959991885560672,
                    13.861547469380994, 13.766939719478465, 13.669856687169062, 13.576557264033234, 13.480816789071344,
                    13.385751466017824, 13.300462359468591, 13.206668877163493, 13.116530800665453, 13.024034384653216,
                    12.935142823988217, 12.843925537191268, 12.753351505248467, 12.666307407733896, 12.576985920434437,
                    12.491145552242031, 12.40305928819644, 12.315594199357001, 12.237123743024931, 12.15082881445505,
                    12.067897051163415, 11.982795491688512, 11.901010588414541, 11.817085894981414, 11.733753029789723,
                    11.653667889619582, 11.571487431267592, 11.492509785278505, 11.4114657971784, 11.33099332288423,
                    11.25879638278135, 11.179400517377216, 11.103098940620036, 11.024801037443954, 10.94955463212163,
                    10.872339507498124, 10.795668895932083, 10.721986361915375, 10.646376025151714, 10.573712443933184,
                    10.49914771947432, 10.42510881772561, 10.35631936517765, 10.283287674182919, 10.213102241380133,
                    10.14108050270162, 10.071865661425036, 10.000839908472793, 9.930315021770364, 9.862538695778749,
                    9.792989094896841, 9.726150044990272, 9.657562242740518, 9.589458114564852, 9.52835759906829,
                    9.461164608651032, 9.396590325219897, 9.3303265439635, 9.26664525569968, 9.201297833608045,
                    9.136411234765408, 9.074053456096417, 9.010064171418351, 8.948568735961507, 8.885464356526542,
                    8.822804982636193, 8.766589300151912, 8.704768220840746, 8.645356489458234, 8.584390331365391,
                    8.525800202425637, 8.465677142879986, 8.40597806492003, 8.348605634301528, 8.289732132488588,
                    8.233153102904637, 8.175093760379394, 8.11744384632127, 8.065722466698027, 8.008843827669399,
                    7.954181915243654, 7.8980898486255455, 7.844183853587326, 7.788867481901525, 7.73394119553672,
                    7.681155546892189, 7.626988833931471, 7.574933155898128, 7.521515512231461, 7.46847456425255,
                    7.419194284724941, 7.3668748954394205, 7.316594545484951, 7.264998678928703, 7.215413653910641,
                    7.164531304516956, 7.114007772178536, 7.065453289383479, 7.01562844494087, 6.967745420134716,
                    6.918609601461119, 6.869820283489136, 6.8260483043350275, 6.777911719038755, 6.731651156991646,
                    6.684180250596583, 6.638559424000653, 6.5917449908600565, 6.5452606882508455, 6.500588014611142,
                    6.454746541552343, 6.4106916445189235, 6.3654841113465475, 6.3205953770134915, 6.280322857840155,
                    6.236034671842036, 6.193472525738193, 6.149796799282234, 6.107823243384304, 6.064751506792137,
                    6.021983507623133, 5.98088230222995, 5.938705740000613, 5.898172921523039, 5.8565796172757265,
                    5.815279624699882, 5.7782267924563016, 5.737479335881812, 5.698319926639872, 5.658135965002808,
                    5.6195180896556325, 5.579889830407181, 5.5405410255364895, 5.502725758458515, 5.463921106627117,
                    5.426628785356003, 5.388360761493413, 5.350362599769596, 5.315058554449183, 5.277577312293538,
                    5.2415568235598196, 5.204593907993824, 5.16907154514946, 5.132619788255565, 5.096425085373989,
                    5.0616409957231685, 5.025946827931388, 4.991643766056754, 4.956443211475153, 4.921490887556822,
                    4.890132949845552, 4.855648239020864, 4.822507498044671, 4.788499674898429, 4.755817235895724,
                    4.722279705567411, 4.688978678427661, 4.656975489527801, 4.624134980952446, 4.592574362864181,
                    4.560188004360524, 4.528030031101013, 4.49917908188377, 4.4674513372235465, 4.436960115392262,
                    4.405671132436327, 4.375601572484882, 4.34474528361528, 4.31410659009732, 4.284661975906129,
                    4.254446983648031, 4.225409557841738, 4.195612407495826, 4.166025383566439, 4.139480995399077,
                    4.110289804371205, 4.0822362792725215, 4.053448772050819, 4.025783198021945, 3.9973937920792992,
                    3.9692045852855222, 3.9421139941703416, 3.9143146147830765, 3.8875986583623927, 3.8601837154741214,
                    3.832962099922237, 3.8076705303951726, 3.7808192323828136, 3.755014407838218, 3.7285344353456638,
                    3.703086464681396, 3.6769726826629783, 3.6510430523293254, 3.626123975383469, 3.6005529248643784,
                    3.5759784528309453, 3.5507610233405917, 3.5257214245498596, 3.5032568187333872, 3.4785522146709447,
                    3.4548104211464166, 3.430447456059524, 3.407033986842356, 3.3830079362193666, 3.3591513148156813,
                    3.336224455590271, 3.312697746444068, 3.290087941832385, 3.266886582600329, 3.243848836949347,
                    3.2231802200407973, 3.2004506871295355, 3.178606990467804, 3.1561917833526127, 3.1346501622930996,
                    3.1125449341751916, 3.0905955898353263, 3.0695016755188407, 3.0478558677786847, 3.027053660354534,
                    3.005707191618662, 2.9845112559682976, 2.965495043157692, 2.944582679411309, 2.9244853315274293,
                    2.903862164017852, 2.8840427415492087, 2.8637047709933143, 2.8435102216982684, 2.8241027129411145,
                    2.804187433255709, 2.785048310156265, 2.765408438072304, 2.745907064331108, 2.7277883619745684,
                    2.7085522811116514
                ],
                [
                    87.32648870636551, 289.1170431211499, 181.38809034907598, 119.9835728952772, 114.2340862422998,
                    89.75770020533881, 82.82546201232033, 72.41067761806981, 61.14168377823409, 61.3388090349076,
                    53.42094455852156, 56.34496919917864, 45.47022587268994, 45.40451745379877, 35.64681724845996,
                    37.09240246406571, 39.030800821355236, 35.97535934291581, 35.97535934291581, 32.427104722792606,
                    29.338809034907598, 31.67145790554415, 25.3305954825462, 26.90759753593429, 27.137577002053387,
                    24.706365503080082, 22.833675564681723, 22.439425051334702, 27.860369609856264, 23.030800821355236,
                    24.870636550308006, 19.252566735112936, 19.64681724845996, 20.073921971252567, 13.305954825462011,
                    23.129363449691994, 18.562628336755647, 15.080082135523615, 15.868583162217659, 19.482546201232033,
                    17.93839835728953, 16.229979466119097, 16.032854209445585, 16.262833675564682, 15.93429158110883,
                    14.850102669404517, 14.652977412731007, 13.897330595482547, 13.535934291581109, 12.517453798767967,
                    13.240246406570842, 11.761806981519507, 12.845995893223819, 14.028747433264886, 13.535934291581109,
                    10.907597535934292, 11.301848049281315, 10.480492813141684, 9.462012320328542, 10.283367556468173,
                    9.724845995893224, 10.053388090349076, 9.626283367556468, 10.151950718685832, 9.790554414784394,
                    7.917864476386037, 8.114989733059549, 8.016427104722792, 8.279260780287474, 7.753593429158111,
                    6.669404517453799, 3.679671457905544, 5.420944558521561, 5.026694045174538, 4.1067761806981515,
                    6.505133470225872, 11.137577002053389, 11.071868583162217, 7.260780287474333, 8.772073921971252,
                    6.505133470225872, 5.092402464065708, 8.049281314168377, 6.373716632443532, 6.439425051334703,
                    6.406570841889117, 4.632443531827516, 7.260780287474333, 5.190965092402464, 0, 0.9527720739219713,
                    12.583162217659138, 8.607802874743326, 5.420944558521561, 5.552361396303901, 5.716632443531828,
                    7.030800821355236, 4.829568788501026, 6.505133470225872, 6.537987679671458, 6.997946611909651,
                    6.669404517453799, 0, 0, 0, 9.69199178644764, 5.815195071868583, 7.063655030800821,
                    5.552361396303901, 4.369609856262834, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                    0, 87.16068630650396, 82.81928262129003, 78.95161857302018, 75.57967848144699, 72.87842929627462,
                    70.20127082856753, 67.872686553306, 65.69441690383411, 63.7743866337922, 61.95721458422506,
                    60.28701966251476, 58.79290932593795, 57.36005236687342, 56.068654482312006, 54.82179705775653,
                    53.65458655598364, 52.627563140298996, 51.592394415955106, 50.64663738738948, 49.72201433839376,
                    48.87378237343442, 48.04133898537069, 47.250032018063735, 46.52032613790715, 45.800722136590906,
                    45.13519832422814, 44.47708609767791, 43.846946718663666, 43.30022515158799, 42.718151272113914,
                    42.176635088787066, 41.638154215982134, 41.136205586562596, 40.636135392333344, 40.15386997420296,
                    39.70314127917755, 39.252974694526706, 38.83159453487089, 38.41011744583423, 38.002073120367065,
                    37.64448051465538, 37.26011302705809, 36.899136370125646, 36.53693397424751, 36.19638088553961,
                    35.8542922018761, 35.52172287076165, 35.20853679168143, 34.89345902208461, 34.596461179447324,
                    34.29739365880485, 34.00595024536867, 33.7489987936766, 33.47120104327838, 33.20879312854333,
                    32.94401922215044, 32.69372431098801, 32.44098745956698, 32.194022723452306, 31.960316485842135,
                    31.72408841956114, 31.500397288552737, 31.274149864127416, 31.05270842013168, 30.849755670526992,
                    30.637146683122314, 30.435526021925035, 30.2313106777479, 30.037546445262272, 29.841186623469717,
                    29.648628028429503, 29.46578618812645, 29.280358907832372, 29.10420594244616, 28.925480413158596,
                    28.750007553338826, 28.59423051272969, 28.424682275949213, 28.263442212165412, 28.09967691212673,
                    27.94387457939853, 27.78557078834088, 27.62992727262863, 27.48176802746904, 27.33114676127389,
                    27.18771738563555, 27.04185396555481, 26.898313325773284, 26.770609409724035, 26.631322864272637,
                    26.498578731437068, 26.3634740000283, 26.234675763755483, 26.1035477023418, 25.974366429191708,
                    25.85116095514984, 25.7256727086944, 25.60595617461783, 25.483988286858718, 25.363746853608806,
                    25.256592023665537, 25.13952603735164, 25.02777242863814, 24.91384521980615, 24.805061407991715,
                    24.694135178911075, 24.58468392217229, 24.480137195888865, 24.373494629523947, 24.271607979460452,
                    24.167655999006563, 24.032278255968542, 23.946950366550745, 23.85607279026786, 23.76845513021927,
                    23.67825493515644, 23.591290357638098, 23.50176249474652, 23.412574385980825, 23.326585589692023,
                    23.238062269231662, 23.152714414285306, 23.064850926946264, 22.977320877504365, 22.89854702235941,
                    22.811648088593778, 22.72786635113237, 22.6416151426713, 22.55845789562723, 22.472849584470517,
                    22.387566152920957, 22.305341967165525, 22.22069421932669, 22.13908291434497, 22.055066111972007,
                    21.9713681495035, 21.896043033003956, 21.812948555813048, 21.732834803309732, 21.650359693851122,
                    21.57084309142193, 21.488982733066447, 21.40743303100945, 21.32880864021747, 21.247866791482867,
                    21.169828449394416, 21.089489923178874, 21.009456277978778, 20.937428913503226, 20.85797233284767,
                    20.781365980023836, 20.70250165102977, 20.62646630490376, 20.548189813059164, 20.470210376904326,
                    20.395028181171824, 20.31762998637225, 20.243008181987697, 20.166186896099735, 20.089657143461793,
                    20.018327741192035, 19.942359107252862, 19.86911558321654, 19.793713202560614, 19.72101561944506,
                    19.646175271346472, 19.57161893893003, 19.49973705502283, 19.42573644890852, 19.35439035655973,
                    19.28094133448743, 19.20777104807893, 19.141920456434008, 19.06927774786973, 18.99924084323023,
                    18.92713959724196, 18.857624732096184, 18.78606091274243, 18.71476867479478, 18.646033797346504,
                    18.57527295586756, 18.50705041289222, 18.43681700697102, 18.366850133598074, 18.303882496961652,
                    18.234420103945876, 18.1674494321217, 18.09850479631792, 18.032033308970743, 17.96360257113197,
                    17.895431524798916, 17.829705877097073, 17.762042962565353, 17.6968072192079, 17.6296486489762,
                    17.5627449424326, 17.50253404432927, 17.436112731869414, 17.37207405243794, 17.3061478296527,
                    17.242586480279734, 17.1771516568809, 17.111965155630145, 17.049116992860416, 16.98441637727645,
                    16.922036670719088, 16.85781831911833, 16.793843673211075, 16.73421623295823, 16.670710651288456,
                    16.609483110969713, 16.546450885766422, 16.48567972190113, 16.423117324870606, 16.360792349262088,
                    16.300703064877943, 16.23884264576118, 16.17920125352418, 16.117801928198517, 16.05663561049118,
                    16.001588153285912, 15.940862861514365, 15.882315877886315, 15.822043218919369, 15.763932631472013,
                    15.70410923148552, 15.6445128585531, 15.58705429773643, 15.527902142898935, 15.470871865401655,
                    15.412160617556307, 15.35367217619876, 15.301034710133901, 15.242967986488807, 15.186984204123902,
                    15.129350296908514, 15.073783805192773, 15.016579488289791, 14.959592259140928, 14.904649248170506,
                    14.84808678913972, 14.793553311140208, 14.737412456085615, 14.68148465299629, 14.631151668070258,
                    14.575627119788786, 14.522094321108796, 14.466983640447879, 14.413849863330364, 14.3591499654129,
                    14.304657651094583, 14.252120058582863, 14.198033917842961, 14.145887928848518, 14.092204934159609,
                    14.038725663968822, 13.988880417577153, 13.935793259179054, 13.884610417517523, 13.831918958978461,
                    13.781117622823006, 13.72881891468433, 13.676718677739927, 13.626487355165525, 13.574775461787379,
                    13.524918552307623, 13.473592107869255, 13.422460444929087, 13.376443811379225, 13.325680821760288,
                    13.276738777425427, 13.226354163828917, 13.17777692259576, 13.127767864691052, 13.07794858886318,
                    13.029916405877076, 12.98046847183915, 12.932794310050836, 12.883714949903826, 12.834821843673385,
                    12.790819829595465, 12.74227925607808, 12.69547990641485, 12.647301143525082, 12.600850625794536,
                    12.553030976676524, 12.505392800929613, 12.459463478662748, 12.41218038727139, 12.36659341194671,
                    12.31966275819117, 12.272910204110183, 12.23083460897097, 12.184419153634632, 12.13966869094623,
                    12.09359920607974, 12.049182303376691, 12.003456210193193, 11.957903645432218, 11.913985120127975,
                    11.868772094042619, 11.825180927647692, 11.78030490939226, 11.735599193564065, 11.693931320898212,
                    11.6495533888695, 11.606767360443216, 11.562720211639263, 11.520253100742716, 11.476534269579009,
                    11.432981349370696, 11.39099073834189, 11.347762451903911, 11.306084829540659, 11.263178757125168,
                    11.22043551128297, 11.181968147470572, 11.139533092160399, 11.098620246523582, 11.05650149266768,
                    11.015893602273144, 10.974088792230898, 10.93244262952184, 10.892290377714286, 10.850954636229696,
                    10.811101670367362, 10.770074036296545, 10.729202100211818, 10.692418846995794, 10.651841608786219,
                    10.612719937538182, 10.572445153027848, 10.533615086006998, 10.49364050077337, 10.453817617253877,
                    10.41542324085123, 10.375897188239072, 10.337788994969763, 10.298557560753446, 10.259475008027302,
                    10.22430213463383, 10.185501377837788, 10.148092462925693, 10.109580918331961, 10.072450841142667,
                    10.034226353027881, 9.996146925089082, 9.959433463876158, 9.921637871514971, 9.885198064267808,
                    9.847684191837033, 9.810312682828375, 9.775480642901135, 9.738383143042949, 9.702616386663912,
                    9.665795403310048, 9.630295244369723, 9.593748716427719, 9.557340880879948, 9.522239049508482,
                    9.486102589860813, 9.451262399725096, 9.415395293201989, 9.379664300700052, 9.347507709386788,
                    9.312034347146005, 9.277833468109375, 9.242624516412722, 9.208678563113729, 9.17373205110388,
                    9.13891815950132, 9.105353094892793, 9.070798698287055, 9.037483820196979, 9.00318698437013,
                    8.969020303459311, 8.938271535578867, 8.904351205813358, 8.871647649626082, 8.837980154446408,
                    8.805520363285627, 8.772103818119076, 8.738814087205947, 8.706718509335607, 8.673676912664867,
                    8.641820568086004, 8.609025256120258, 8.576354400856484, 8.546951821554636, 8.514516532122773,
                    8.483244745624287, 8.451051221618252, 8.420012528053775, 8.388058967407913, 8.35622666905644,
                    8.325536243435462, 8.293941215948555, 8.263479549927045, 8.23212002474051, 8.200879507511093,
                    8.17176184616029, 8.140750385445136, 8.110851352771856, 8.080071044580286, 8.050394872639643,
                    8.01984399401221, 7.98940905456536, 7.960065862469734, 7.929857778285294, 7.900733303810395,
                    7.870750383959745, 7.840881247912222, 7.8140001138181, 7.784346342438097, 7.755756296728207,
                    7.726323557957767, 7.6979466160831285, 7.668733262394391, 7.639630772040555, 7.611572232071877,
                    7.5826866652015745, 7.554837267342694, 7.526167007056578, 7.497605549090853, 7.471901277622184,
                    7.443545755606163, 7.416207389090242, 7.388063222822074, 7.360928630403376, 7.332994244484375,
                    7.305165868276358, 7.278335738050301, 7.250714788362652, 7.2240846439536694, 7.196669574675289,
                    7.169358544325102, 7.144779612148296, 7.117665501821564, 7.091524015678355, 7.064612007893142,
                    7.038665374567339, 7.011953962896296, 6.985343919805161, 6.9596884192427355, 6.9332767214881725,
                    6.907812451314836, 6.881597620474868, 6.855482273713373, 6.831141517205536, 6.805217649037497,
                    6.7802237092649245, 6.754493071838357, 6.729685431328042, 6.704146584344018, 6.678704656110794,
                    6.654175368358001, 6.6289230785932745, 6.604576626690035, 6.579512561870886, 6.554543614026035,
                    6.5320724707650255, 6.507283555886057, 6.483383856909955, 6.458779713083334, 6.435058157142219,
                    6.410637407125659, 6.3863093327332825, 6.362853943197883, 6.3387072048554725, 6.315426646571414,
                    6.291459892640423, 6.267584091439332, 6.246096740326469, 6.222393090203981, 6.199539725894638,
                    6.176012757502632, 6.1533297370826325, 6.129978133474828, 6.106715148129712, 6.084286641285088,
                    6.061197053053316, 6.0389357233050855, 6.016018239723181, 5.993187726938416, 5.972641097312828,
                    5.949975198790337, 5.928122360360123, 5.90562540839874, 5.8839354561607315, 5.861606191470405,
                    5.839361665313552, 5.817915083984334, 5.795836363572793, 5.7745496402858, 5.752635489740461,
                    5.730804502389488, 5.710456974466976, 5.688786052643372, 5.6678924995916296, 5.646383107994347,
                    5.625645290835181, 5.604296225453877, 5.5830281787947085, 5.562523049165372, 5.541413529790749,
                    5.521061240832278, 5.500109067115116, 5.479236405934462, 5.46045177141388, 5.439729607848166,
                    5.41975077965935, 5.399183074487142, 5.37935316403543, 5.358938765958251, 5.3386018395837365,
                    5.318994429544888, 5.298809090091628, 5.279347829321689, 5.259312946894521, 5.239354095925565,
                    5.221391857298796, 5.201576915122388, 5.1824727649182645, 5.162805518909115, 5.1438437667871435,
                    5.124323116050906, 5.104876545287243, 5.086127552455637, 5.066825932100737, 5.048216690087304,
                    5.029058939713096, 5.009973892121262, 4.992798044694926, 4.973850605533504, 4.955582839697969,
                    4.9367766305294785, 4.91864502855323, 4.899978996680748, 4.881383801541521, 4.863455644201866,
                    4.844999053507055, 4.827204528660572, 4.808885509283508, 4.790636009743224, 4.7736266003428165,
                    4.755510906741821, 4.738045050494339, 4.720064387240054, 4.702728717596333, 4.684882078202615,
                    4.667103165985347, 4.649962010263529, 4.632315618099518, 4.615302228736036, 4.597787368850312,
                    4.5803389770530485, 4.564636060206619, 4.547313476102364, 4.530612279313341, 4.513418813894186,
                    4.496842104107569, 4.479776794951587, 4.462776247859705, 4.446385536127916, 4.429511707328946,
                    4.413243168313072, 4.396495113277075, 4.379810616340368, 4.3647951770342255, 4.348230979898953,
                    4.332260965590272, 4.31582023429249, 4.2999692569148, 4.283651071167642, 4.267394812185578,
                    4.25172168982238, 4.2355866013753705, 4.220030302976707, 4.204015481886564, 4.188061436306579,
                    4.17370337660586, 4.157864364072579, 4.14259352089641, 4.126872568836054, 4.111715551124924,
                    4.096111779541014, 4.080567223553275, 4.065580274320601
                ]
            ],
            'data_part_idx': [[0, 104, True], [0, 110, True]]
        },
        'cum_dict': {
            'cum_subind': [[6, 726], [0, 720]],
            'idx': [
                40860, 40890, 40921, 40952, 40981, 41012, 41042, 41073, 41103, 41134, 41165, 41195, 41226, 41256, 41287,
                41318, 41346, 41377, 41407, 41438, 41468, 41499, 41530, 41560, 41591, 41621, 41652, 41683, 41711, 41742,
                41772, 41803, 41833, 41864, 41895, 41925, 41956, 41986, 42017, 42048, 42076, 42107, 42137, 42168, 42198,
                42229, 42260, 42290, 42321, 42351, 42382, 42413, 42442, 42473, 42503, 42534, 42564, 42595, 42626, 42656,
                42687, 42717, 42748, 42779, 42807, 42838, 42868, 42899, 42929, 42960, 42991, 43021, 43052, 43082, 43113,
                43144, 43172, 43203, 43233, 43264, 43294, 43325, 43356, 43386, 43417, 43447, 43478, 43509, 43537, 43568,
                43598, 43629, 43659, 43690, 43721, 43751, 43782, 43812, 43843, 43874, 43903, 43934, 43964, 43995, 44025,
                44056, 44087, 44117, 44148, 44178, 44209, 44240, 44268, 44299, 44329, 44360, 44390, 44421, 44452, 44482,
                44513, 44543, 44574, 44605, 44633, 44664, 44694, 44725, 44755, 44786, 44817, 44847, 44878, 44908, 44939,
                44970, 44998, 45029, 45059, 45090, 45120, 45151, 45182, 45212, 45243, 45273, 45304, 45335, 45364, 45395,
                45425, 45456, 45486, 45517, 45548, 45578, 45609, 45639, 45670, 45701, 45729, 45760, 45790, 45821, 45851,
                45882, 45913, 45943, 45974, 46004, 46035, 46066, 46094, 46125, 46155, 46186, 46216, 46247, 46278, 46308,
                46339, 46369, 46400, 46431, 46459, 46490, 46520, 46551, 46581, 46612, 46643, 46673, 46704, 46734, 46765,
                46796, 46825, 46856, 46886, 46917, 46947, 46978, 47009, 47039, 47070, 47100, 47131, 47162, 47190, 47221,
                47251, 47282, 47312, 47343, 47374, 47404, 47435, 47465, 47496, 47527, 47555, 47586, 47616, 47647, 47677,
                47708, 47739, 47769, 47800, 47830, 47861, 47892, 47920, 47951, 47981, 48012, 48042, 48073, 48104, 48134,
                48165, 48195, 48226, 48257, 48286, 48317, 48347, 48378, 48408, 48439, 48470, 48500, 48531, 48561, 48592,
                48623, 48651, 48682, 48712, 48743, 48773, 48804, 48835, 48865, 48896, 48926, 48957, 48988, 49016, 49047,
                49077, 49108, 49138, 49169, 49200, 49230, 49261, 49291, 49322, 49353, 49381, 49412, 49442, 49473, 49503,
                49534, 49565, 49595, 49626, 49656, 49687, 49718, 49747, 49778, 49808, 49839, 49869, 49900, 49931, 49961,
                49992, 50022, 50053, 50084, 50112, 50143, 50173, 50204, 50234, 50265, 50296, 50326, 50357, 50387, 50418,
                50449, 50477, 50508, 50538, 50569, 50599, 50630, 50661, 50691, 50722, 50752, 50783, 50814, 50842, 50873,
                50903, 50934, 50964, 50995, 51026, 51056, 51087, 51117, 51148, 51179, 51208, 51239, 51269, 51300, 51330,
                51361, 51392, 51422, 51453, 51483, 51514, 51545, 51573, 51604, 51634, 51665, 51695, 51726, 51757, 51787,
                51818, 51848, 51879, 51910, 51938, 51969, 51999, 52030, 52060, 52091, 52122, 52152, 52183, 52213, 52244,
                52275, 52303, 52334, 52364, 52395, 52425, 52456, 52487, 52517, 52548, 52578, 52609, 52640, 52669, 52700,
                52730, 52761, 52791, 52822, 52853, 52883, 52914, 52944, 52975, 53006, 53034, 53065, 53095, 53126, 53156,
                53187, 53218, 53248, 53279, 53309, 53340, 53371, 53399, 53430, 53460, 53491, 53521, 53552, 53583, 53613,
                53644, 53674, 53705, 53736, 53764, 53795, 53825, 53856, 53886, 53917, 53948, 53978, 54009, 54039, 54070,
                54101, 54130, 54161, 54191, 54222, 54252, 54283, 54314, 54344, 54375, 54405, 54436, 54467, 54495, 54526,
                54556, 54587, 54617, 54648, 54679, 54709, 54740, 54770, 54801, 54832, 54860, 54891, 54921, 54952, 54982,
                55013, 55044, 55074, 55105, 55135, 55166, 55197, 55225, 55256, 55286, 55317, 55347, 55378, 55409, 55439,
                55470, 55500, 55531, 55562, 55591, 55622, 55652, 55683, 55713, 55744, 55775, 55805, 55836, 55866, 55897,
                55928, 55956, 55987, 56017, 56048, 56078, 56109, 56140, 56170, 56201, 56231, 56262, 56293, 56321, 56352,
                56382, 56413, 56443, 56474, 56505, 56535, 56566, 56596, 56627, 56658, 56686, 56717, 56747, 56778, 56808,
                56839, 56870, 56900, 56931, 56961, 56992, 57023, 57052, 57083, 57113, 57144, 57174, 57205, 57236, 57266,
                57297, 57327, 57358, 57389, 57417, 57448, 57478, 57509, 57539, 57570, 57601, 57631, 57662, 57692, 57723,
                57754, 57782, 57813, 57843, 57874, 57904, 57935, 57966, 57996, 58027, 58057, 58088, 58119, 58147, 58178,
                58208, 58239, 58269, 58300, 58331, 58361, 58392, 58422, 58453, 58484, 58513, 58544, 58574, 58605, 58635,
                58666, 58697, 58727, 58758, 58788, 58819, 58850, 58878, 58909, 58939, 58970, 59000, 59031, 59062, 59092,
                59123, 59153, 59184, 59215, 59243, 59274, 59304, 59335, 59365, 59396, 59427, 59457, 59488, 59518, 59549,
                59580, 59608, 59639, 59669, 59700, 59730, 59761, 59792, 59822, 59853, 59883, 59914, 59945, 59974, 60005,
                60035, 60066, 60096, 60127, 60158, 60188, 60219, 60249, 60280, 60311, 60339, 60370, 60400, 60431, 60461,
                60492, 60523, 60553, 60584, 60614, 60645, 60676, 60704, 60735, 60765, 60796, 60826, 60857, 60888, 60918,
                60949, 60979, 61010, 61041, 61069, 61100, 61130, 61161, 61191, 61222, 61253, 61283, 61314, 61344, 61375,
                61406, 61435, 61466, 61496, 61527, 61557, 61588, 61619, 61649, 61680, 61710, 61741, 61772, 61800, 61831,
                61861, 61892, 61922, 61953, 61984, 62014, 62045, 62075, 62106, 62137, 62165, 62196, 62226, 62257, 62287,
                62318, 62349, 62379, 62410, 62440, 62471, 62502, 62530, 62561, 62591, 62622, 62652, 62683, 62714, 62744,
                62775, 62805, 62836, 62867, 62896, 62927
            ],
            'sum': [
                87.32648870636551, 289.1170431211499, 181.38809034907598, 119.9835728952772, 114.2340862422998,
                89.75770020533881, 232.24640657084188, 464.85420944558524, 271.0800821355236, 222.258726899384,
                53.42094455852156, 57.49486652977412, 45.47022587268994, 129.34702258726898, 112.49281314168377,
                99.05544147843942, 76.61601642710473, 67.35112936344969, 52.50102669404517, 44.94455852156057,
                32.62422997946612, 62.587268993839835, 44.681724845995895, 51.84394250513347, 27.137577002053387,
                42.48049281314168, 73.72484599589322, 22.439425051334702, 72.4435318275154, 63.27720739219713,
                70.6694045174538, 54.078028747433265, 68.50102669404518, 44.78028747433265, 43.958932238193015,
                37.059548254620125, 20.928131416837783, 53.158110882956876, 55.16221765913758, 44.813141683778234,
                50.13552361396304, 41.59342915811088, 51.41683778234086, 44.51745379876797, 45.04312114989733,
                25.42915811088296, 41.52772073921971, 46.652977412731005, 45.765913757700204, 39.753593429158116,
                36.73100616016427, 30.784394250513344, 32.85420944558521, 26.940451745379875, 40.41067761806981,
                31.93429158110883, 34.10266940451746, 25.95482546201232, 22.275154004106774, 25.527720739219713,
                20.928131416837783, 18.365503080082135, 20.6652977412731, 32.16427104722793, 28.320328542094458,
                20.928131416837783, 14.784394250513348, 26.809034907597535, 23.293634496919918, 14.685831622176591,
                16.295687885010267, 14.291581108829568, 14.62012320328542, 10.316221765913758, 4.1067761806981515,
                17.93839835728953, 26.809034907597535, 29.27310061601643, 27.794661190965094, 20.79671457905544,
                21.190965092402465, 5.092402464065708, 8.049281314168377, 6.373716632443532, 6.4722792607802875,
                6.439425051334702, 4.632443531827516, 7.260780287474333, 17.084188911704313, 2.2340862422997945,
                0.9527720739219713, 12.616016427104723, 9.13347022587269, 19.7782340862423, 5.552361396303901,
                18.0041067761807, 11.728952772073923, 7.293634496919918, 7.260780287474332, 7.063655030800821,
                19.21971252566735, 12.484599589322382, 16.164271047227928, 1.8726899383983573, 0, 9.69199178644764,
                5.815195071868583, 7.063655030800821, 11.466119096509239, 8.93634496919918, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 87.16068630650396, 950.116081766613, 786.4407978001069,
                683.2833435390387, 616.9398148102683, 561.1735216002628, 518.7955460227587, 483.2389508667143,
                454.60145636555205, 429.47822181138196, 407.8618959614748, 389.5828117787017, 372.8953326974853,
                358.49745816733923, 345.12586547279216, 333.0445690528657, 322.7393747288372, 312.64122996674797,
                303.6543843393071, 295.0772409671707, 287.3814462925265, 279.982173781829, 273.0832660341837,
                266.8331107689619, 260.77048244457376, 255.24962766327945, 249.86895473801434, 244.7880245426242,
                240.4343758674145, 235.85350116104522, 231.64079178275165, 227.49732528480305, 223.6749647601719,
                219.90440863155834, 216.30278258110354, 212.96682132262796, 209.66351342899466, 206.5967566714845,
                203.5533388062306, 200.62942784459636, 198.08494798567617, 195.36831319190222, 192.8340673838411,
                190.3075861033836, 187.94686203758684, 185.5896848095813, 183.31155676250916, 181.17818012935166,
                179.0434946485732, 177.04181001011662, 175.03636278477208, 173.0917664490463, 171.38519126311792,
                169.5483872072987, 167.82111364400734, 166.08584612445765, 164.45240692063322, 162.80981007444444,
                161.21125006845142, 159.70439704107957, 158.18705409544776, 156.75554374882287, 155.31288332060322,
                153.90590291710612, 152.6207377011832, 151.278849714893, 150.01046855795414, 148.72985888304362,
                147.51857218780094, 146.29479624615885, 145.09834143317227, 143.96556914744667, 142.82005101631356,
                141.73486184829102, 140.63682995691158, 138.22396123530646, 137.2691063369958, 136.22226692220042,
                135.21937424244246, 134.19341346855262, 133.21043080561702, 132.20474665049207, 131.2091460282732,
                130.2551267807422, 129.27895088344516, 128.3434696506332, 127.38618730589, 126.43831093208856,
                125.59014276746211, 124.65981730395825, 123.7681134616969, 122.85546774714078, 121.98065132435559,
                121.08523141039444, 120.19839768248643, 119.34824301716775, 118.47798548415015, 117.64367226102432,
                116.78958160925387, 115.94355514333817, 115.18625061422388, 114.35529837603899, 113.5585596848488,
                112.7428268272793, 111.96064144901614, 111.15976933606993, 110.36631605009319, 109.60543907633351,
                108.82632935024493, 108.07917304654673, 107.31407864196166, 106.52323445942318, 105.82982012674768,
                105.0943127127346, 104.38811873379761, 103.66410752639987, 102.96894108187108, 102.25622488539906,
                101.54917291122558, 100.87027462209298, 100.1742214863466, 99.50587404042523, 98.82062807196672,
                98.14080199214288, 97.53138403886422, 96.86174078128624, 96.21872817011564, 95.55943320188673,
                94.92634790207819, 94.27722195288572, 93.63319625789099, 93.01475933835229, 92.3806387061519,
                91.77170425952403, 91.14731782966729, 90.52781384916182, 89.97242276605019, 89.36209308515842,
                88.77598319978752, 88.17497853972529, 87.59781512482124, 87.00597558056296, 86.41873340440804,
                85.85477402939301, 85.27646147379737, 84.72106953931473, 84.1515341328976, 83.58640173151602,
                83.07971219980348, 82.52285428738483, 81.98804733559396, 81.43960131800985, 80.91286549411372,
                80.3726885888598, 79.83666015610979, 79.32183909870602, 78.79386945348352, 78.28678100629298,
                77.76673394384444, 77.250661726961, 76.77145265099477, 76.26297682840926, 75.77459367299612,
                75.2737119363887, 74.79261587070967, 74.29920063220462, 73.80953170527826, 73.3391953600513,
                72.85680494775615, 72.3934531332892, 71.91821947235198, 71.4465769055234, 71.02363834953334,
                70.55874620569696, 70.11218631519401, 69.65415905577186, 69.21418710453605, 68.76291056588641,
                68.31502164181148, 67.88477919825378, 67.44347275402842, 67.01954746665106, 66.5847145034098,
                66.15313020884903, 65.76608165721396, 65.34060488210336, 64.93187158661345, 64.51260694444684,
                64.10983568359043, 63.69668091768811, 63.28659257885932, 62.89262834436451, 62.48849915579584,
                62.10025436330274, 61.701986652718226, 61.30666086199385, 60.952100631471936, 60.562306367208,
                60.18782021239443, 59.80365316725089, 59.43456814236347, 59.05593663165962, 58.680083654411376,
                58.31897879824122, 57.94852618395069, 57.59260490022022, 57.22746503758924, 56.86499202651348,
                56.5282991827913, 56.170925448527726, 55.82755831827218, 55.475285785159826, 55.13681531595689,
                54.78956171978898, 54.44482767538136, 54.11359355541644, 53.77375713968009, 53.44722443621717,
                53.112207006747944, 52.779608880293736, 52.48126066430916, 52.153212549088906, 51.83799614887404,
                51.51457829326132, 51.2038068676498, 50.88494536433242, 50.568371479708546, 50.264170270373846,
                49.95204373037605, 49.65211204898335, 49.34436217082393, 49.03880980917198, 48.76470105672158,
                48.46328209598783, 48.17363012262166, 47.876418150171496, 47.590805152567, 47.29773370337935,
                47.006741356407986, 46.72709969700927, 46.44014982227558, 46.16438932673664, 45.881418332865685,
                45.60044537882621, 45.34836740740743, 45.07115310608861, 44.8047399233206, 44.53135180898031,
                44.26861231015098, 43.99899055204926, 43.73126024782495, 43.47395314456952, 43.209900914629706,
                42.95612540674916, 42.69569398379437, 42.43708101395747, 42.19678624640471, 41.94165204931315,
                41.696439616761864, 41.44478778802762, 41.20291919720464, 40.95469584113669, 40.70819446632552,
                40.471271530955136, 40.22811908806217, 39.99441197482947, 39.75455685637951, 39.516357933288475,
                39.30262325020435, 39.06754065810298, 38.84158282413614, 38.60967356862824, 38.38676308302555,
                38.157978554011166, 37.93076363743872, 37.71236119099718, 37.488199246404236, 37.2727286606686,
                37.05157312308094, 36.831927839958155, 36.63482689729212, 36.418023674406626, 36.20961331578533,
                35.99561532073321, 35.78980803037663, 35.578462256585816, 35.36845112545198, 35.16647699586823,
                34.95906639815665, 34.759592552876754, 34.5547487896429, 34.351196712967976, 34.16844636114746,
                33.967329141009, 33.77390609289772, 33.57527420770988, 33.384240706785675, 33.18806199257628,
                32.9931177830823, 32.805629841543904, 32.613091101769534, 32.42791593482081, 32.237751564243084,
                32.04878205449773, 31.87307886834581, 31.686399678866742, 31.506858288398313, 31.322477760507564,
                31.145146471967976, 30.963034926370316, 30.782065222809365, 30.6080133616218, 30.429268622998976,
                30.25735602019171, 30.08080754715591, 29.905364333053946, 29.747843445112508, 29.574483761083062,
                29.407748801702922, 29.236515970550343, 29.07182595536078, 28.90269258140167, 28.734615762614133,
                28.572960226471448, 28.40694223336414, 28.247266247196862, 28.083280587344223, 27.920317712734025,
                27.773998966131707, 27.612964194992323, 27.458079572512, 27.299013057447944, 27.146020920389482,
                26.98889737066418, 26.8327516450111, 26.682567867202078, 26.528327596359762, 26.3799759328181,
                26.227616658679807, 26.076204031836006, 25.940252753106332, 25.790624741106477, 25.64670783265243,
                25.498901658507783, 25.356736482533705, 25.21072879590242, 25.06562624539407, 24.926060665119692,
                24.782721968644722, 24.64485238015218, 24.50325495494771, 24.36253387959391, 24.231679884693865,
                24.092638765799094, 23.95890143081082, 23.821546602626157, 23.68943069626617, 23.55374060198839,
                23.418888350260943, 23.289178768986947, 23.155959277029876, 23.02781966375833, 22.896212082273333,
                22.765415766717876, 22.64797006885538, 22.518703224309498, 22.39436426877483, 22.266658901065938,
                22.143821387101944, 22.017657588295148, 21.892269664749787, 21.771660502626688, 21.64778461872149,
                21.52862937243901, 21.40624627256657, 21.28461450281631, 21.175395278603798, 21.05518002026841,
                20.939544700789497, 20.82077564613492, 20.706530951700167, 20.589189713100488, 20.47256711699567,
                20.36038639895519, 20.24516434393246, 20.13433035336451, 20.020491053298656, 19.907347723740713,
                19.805748204335984, 19.693917049499987, 19.586343686244323, 19.475852259062208, 19.369567160175407,
                19.260398474906037, 19.15189556498852, 19.047522605350835, 18.940317241100267, 18.83719199386023,
                18.731267744214833, 18.625988325236705, 18.52808121133794, 18.424038059628053, 18.323953594151988,
                18.221151547281906, 18.12226053406468, 18.020683902485004, 17.919724076335726, 17.822604558248482,
                17.722846873182135, 17.626883348800668, 17.528312626700263, 17.430339362477074, 17.34235771288639,
                17.24551095108913, 17.152346621948105, 17.056650101921267, 16.964591871782808, 16.870031096002435,
                16.776042006805962, 16.685625688168294, 16.592750836619928, 16.5034060033042, 16.41163136358312,
                16.320410531727045, 16.238490577774094, 16.148313976446907, 16.061563878548476, 15.972453554187465,
                15.886728832829014, 15.798671387364362, 15.711143933196388, 15.62694137235183, 15.54044692085124,
                15.457237746858308, 15.371763335054682, 15.286802390646372, 15.210502078846323, 15.126509329490963,
                15.04570593092201, 14.962701856518688, 14.882849228154665, 14.80082144479782, 14.719285115341881,
                14.640843966134923, 14.560265555419644, 14.482745607212964, 14.403113132706329, 14.323956837965923,
                14.250335801930476, 14.172092544476918, 14.096818254749875, 14.01949175076706, 13.945099085238683,
                13.868677888860974, 13.792712428289331, 13.719628657741481, 13.644551523534144, 13.572322046824752,
                13.498122163332006, 13.424363897515171, 13.358120775100053, 13.285195274924813, 13.215035013901602,
                13.142959963679917, 13.073617581142873, 13.002382397985716, 12.931570020984129, 12.863441957809025,
                12.793453746407815, 12.726118291090337, 12.65694400398697, 12.588179468452823, 12.526419598166624,
                12.458427762046018, 12.393012251632832, 12.325809556784867, 12.261152980466935, 12.194729640266965,
                12.128698655752846, 12.065168943515037, 11.99990279305393, 11.937108644828125, 11.872597856998908,
                11.8084673516383, 11.750867889769129, 11.687454534672149, 11.626442286999996, 11.563761373401547,
                11.503453545816363, 11.441496021877587, 11.379902690850042, 11.320640842442849, 11.25975747019991,
                11.201178425641803, 11.140996251233874, 11.081167102159085, 11.02551552891616, 10.96636336493691,
                10.909449323151449, 10.850977015988171, 10.79471683598464, 10.736916013709441, 10.679453264168696,
                10.624164044888541, 10.567360357722137, 10.512705006889032, 10.45655227859027, 10.400727293491284,
                10.350584721259432, 10.29537784686903, 10.242258277704021, 10.187682749385571, 10.135170399931154,
                10.081218471525663, 10.027580518011398, 9.97596991907269, 9.922944071044075, 9.87192219218587,
                9.819500951255044, 9.767384127026578, 9.720570939182565, 9.669028252345935, 9.619432880310526,
                9.568476651345442, 9.519445339272025, 9.469068399666186, 9.418983135384563, 9.370789528361765,
                9.321272915748768, 9.273626247929041, 9.224671347208922, 9.175999275687701, 9.132279040094001,
                9.084140409904709, 9.03781911897049, 8.990225402580297, 8.944428226575175, 8.897372788760046,
                8.850588386827043, 8.805569638372209, 8.759313668290131, 8.714803187022966, 8.66906922475763,
                8.623598109665462, 8.581297130737989, 8.536330139124635, 8.493059458332556, 8.448598822585717,
                8.40581518227773, 8.361854760865594, 8.318146218314673, 8.276085985646997, 8.232868542963896,
                8.191280681566981, 8.148548392190904, 8.106060401602909, 8.067892878940008, 8.025865690773308,
                7.9854227004597576, 7.943866269953711, 7.903876090949925, 7.8627847311709544, 7.821927562675386,
                7.782609991718187, 7.742209453773015, 7.703331110145458, 7.663381695877403, 7.623659453289715,
                7.587975397075023, 7.548681667028489, 7.5108679560580764, 7.472012017645103, 7.434619419207899,
                7.3961960053428335, 7.357990402020905, 7.321223365341221, 7.283442469154055, 7.247083963331241,
                7.209722673505226, 7.172572692274876, 7.139198419763552, 7.102447043483888, 7.0670788524238395,
                7.030734732853906, 6.995758292674132, 6.9598165505343275, 6.924077445251543, 6.889682987261715,
                2.804187433255709, 2.785048310156265, 2.765408438072304, 2.745907064331108, 2.7277883619745684,
                2.7085522811116514
            ],
            'cum': [
                87.32648870636551, 376.4435318275154, 557.8316221765914, 677.8151950718686, 792.0492813141684,
                881.8069815195072, 1114.053388090349, 1578.9075975359342, 1849.9876796714577, 2072.246406570842,
                2125.6673511293634, 2183.1622176591377, 2228.6324435318274, 2357.9794661190963, 2470.47227926078,
                2569.527720739219, 2646.1437371663237, 2713.4948665297734, 2765.9958932238187, 2810.9404517453795,
                2843.5646817248457, 2906.1519507186854, 2950.8336755646815, 3002.677618069815, 3029.8151950718684,
                3072.29568788501, 3146.0205338809033, 3168.459958932238, 3240.9034907597534, 3304.1806981519503,
                3374.850102669404, 3428.928131416837, 3497.4291581108823, 3542.209445585215, 3586.168377823408,
                3623.227926078028, 3644.1560574948658, 3697.3141683778226, 3752.4763860369603, 3797.2895277207385,
                3847.4250513347015, 3889.018480492812, 3940.435318275153, 3984.9527720739206, 4029.995893223818,
                4055.4250513347006, 4096.952772073921, 4143.605749486652, 4189.371663244352, 4229.12525667351,
                4265.856262833675, 4296.640657084188, 4329.494866529773, 4356.435318275153, 4396.845995893223,
                4428.780287474331, 4462.882956878849, 4488.837782340861, 4511.112936344968, 4536.640657084188,
                4557.568788501026, 4575.934291581108, 4596.599589322381, 4628.763860369609, 4657.084188911703,
                4678.01232032854, 4692.7967145790535, 4719.605749486651, 4742.899383983571, 4757.585215605748,
                4773.880903490758, 4788.172484599588, 4802.792607802873, 4813.108829568787, 4817.215605749485,
                4835.154004106775, 4861.963039014372, 4891.236139630389, 4919.030800821353, 4939.827515400409,
                4961.018480492811, 4966.110882956877, 4974.160164271045, 4980.533880903488, 4987.006160164268,
                4993.445585215603, 4998.078028747431, 5005.338809034905, 5022.42299794661, 5024.65708418891,
                5025.609856262831, 5038.225872689936, 5047.359342915809, 5067.137577002051, 5072.6899383983555,
                5090.694045174536, 5102.42299794661, 5109.71663244353, 5116.977412731005, 5124.041067761806,
                5143.260780287473, 5155.745379876795, 5171.909650924023, 5173.782340862421, 5173.782340862421,
                5183.474332648869, 5189.289527720737, 5196.353182751538, 5207.819301848047, 5216.755646817246,
                5216.755646817246, 5216.755646817246, 5216.755646817246, 5216.755646817246, 5216.755646817246,
                5216.755646817246, 5216.755646817246, 5216.755646817246, 5216.755646817246, 5216.755646817246,
                5216.755646817246, 5216.755646817246, 5216.755646817246, 5216.755646817246, 5216.755646817246,
                5216.755646817246, 5216.755646817246, 5216.755646817246, 5216.755646817246, 5216.755646817246,
                5216.755646817246, 5216.755646817246, 5303.91633312375, 6254.032414890363, 7040.47321269047,
                7723.7565562295085, 8340.696371039778, 8901.869892640041, 9420.6654386628, 9903.904389529514,
                10358.505845895066, 10787.984067706448, 11195.845963667922, 11585.428775446624, 11958.32410814411,
                12316.82156631145, 12661.947431784241, 12994.992000837106, 13317.731375565943, 13630.372605532692,
                13934.026989871998, 14229.104230839168, 14516.485677131694, 14796.467850913523, 15069.551116947707,
                15336.38422771667, 15597.154710161243, 15852.404337824522, 16102.273292562537, 16347.061317105161,
                16587.495692972574, 16823.349194133618, 17054.98998591637, 17282.487311201174, 17506.162275961346,
                17726.066684592904, 17942.36946717401, 18155.336288496637, 18364.99980192563, 18571.596558597117,
                18775.14989740335, 18975.779325247946, 19173.864273233623, 19369.232586425525, 19562.066653809365,
                19752.374239912748, 19940.321101950336, 20125.910786759916, 20309.222343522426, 20490.400523651777,
                20669.44401830035, 20846.485828310466, 21021.52219109524, 21194.613957544287, 21365.999148807405,
                21535.547536014703, 21703.36864965871, 21869.454495783168, 22033.906902703802, 22196.716712778245,
                22357.927962846697, 22517.63235988778, 22675.819413983227, 22832.57495773205, 22987.887841052652,
                23141.79374396976, 23294.41448167094, 23445.693331385835, 23595.70379994379, 23744.433658826834,
                23891.952231014635, 24038.247027260793, 24183.345368693965, 24327.310937841412, 24470.130988857727,
                24611.865850706017, 24752.50268066293, 24890.726641898236, 25027.995748235233, 25164.218015157432,
                25299.437389399875, 25433.63080286843, 25566.841233674048, 25699.04598032454, 25830.25512635281,
                25960.510253133554, 26089.789204017, 26218.132673667635, 26345.518860973523, 26471.95717190561,
                26597.547314673073, 26722.20713197703, 26845.975245438727, 26968.830713185867, 27090.811364510224,
                27211.896595920618, 27332.094993603103, 27451.44323662027, 27569.92122210442, 27687.564894365445,
                27804.3544759747, 27920.298031118036, 28035.48428173226, 28149.8395801083, 28263.39813979315,
                28376.140966620427, 28488.101608069443, 28599.261377405513, 28709.627693455608, 28819.233132531943,
                28928.05946188219, 29036.138634928735, 29143.452713570696, 29249.975948030118, 29355.805768156864,
                29460.9000808696, 29565.288199603398, 29668.9523071298, 29771.92124821167, 29874.17747309707,
                29975.726646008294, 30076.596920630385, 30176.771142116733, 30276.277016157157, 30375.097644229125,
                30473.23844622127, 30570.76983026013, 30667.631571041416, 30763.850299211532, 30859.40973241342,
                30954.336080315497, 31048.613302268383, 31142.246498526274, 31235.261257864626, 31327.641896570778,
                31419.413600830303, 31510.56091865997, 31601.08873250913, 31691.061155275183, 31780.42324836034,
                31869.199231560127, 31957.374210099853, 32044.972025224673, 32131.978000805237, 32218.396734209644,
                32304.25150823904, 32389.527969712835, 32474.24903925215, 32558.400573385046, 32641.98697511656,
                32725.066687316365, 32807.58954160375, 32889.57758893935, 32971.01719025736, 33051.93005575147,
                33132.30274434033, 33212.13940449644, 33291.46124359515, 33370.25511304863, 33448.54189405493,
                33526.30862799877, 33603.55928972573, 33680.330742376726, 33756.593719205135, 33832.368312878134,
                33907.64202481452, 33982.434640685235, 34056.73384131744, 34130.543373022716, 34203.88256838277,
                34276.73937333052, 34349.132826463814, 34421.05104593617, 34492.49762284169, 34563.52126119123,
                34634.08000739692, 34704.192193712115, 34773.84635276789, 34843.06053987243, 34911.823450438314,
                34980.13847208013, 35048.023251278384, 35115.46672403241, 35182.48627149907, 35249.07098600248,
                35315.22411621133, 35380.990197868545, 35446.33080275065, 35511.26267433726, 35575.775281281705,
                35639.8851169653, 35703.58179788299, 35766.868390461845, 35829.76101880621, 35892.24951796201,
                35954.34977232531, 36016.05175897803, 36077.35841984002, 36138.310520471496, 36198.872826838706,
                36259.0606470511, 36318.864300218345, 36378.29886836071, 36437.35480499237, 36496.034888646784,
                36554.353867445025, 36612.302393628976, 36669.8949985292, 36727.12246356679, 36783.987455593306,
                36840.5157547761, 36896.68668022462, 36952.51423854289, 37007.98952432805, 37063.126339644004,
                37117.91590136379, 37172.360729039174, 37226.47432259459, 37280.24807973427, 37333.69530417049,
                37386.80751117724, 37439.587120057535, 37492.068380721845, 37544.22159327094, 37596.05958941981,
                37647.57416771307, 37698.77797458072, 37749.662919945054, 37800.23129142476, 37850.495461695136,
                37900.44750542551, 37950.099617474494, 37999.443979645315, 38048.48278945449, 38097.24749051121,
                38145.7107726072, 38193.88440272982, 38241.76082087999, 38289.351626032556, 38336.64935973594,
                38383.65610109235, 38430.38320078936, 38476.82335061163, 38522.98773993837, 38568.869158271234,
                38614.46960365006, 38659.81797105747, 38704.88912416356, 38749.693864086876, 38794.22521589586,
                38838.49382820601, 38882.49281875806, 38926.224079005886, 38969.69803215045, 39012.907933065086,
                39055.86405847184, 39098.55975245563, 39140.99683346959, 39183.193619715996, 39225.135271765306,
                39266.83171138207, 39308.2764991701, 39349.4794183673, 39390.43411420844, 39431.14230867476,
                39471.61358020572, 39511.84169929378, 39551.83611126861, 39591.59066812499, 39631.10702605828,
                39670.40964930848, 39709.47718996658, 39748.31877279071, 39786.92844635934, 39825.31520944237,
                39863.47318799638, 39901.403951633816, 39939.116312824815, 39976.60451207122, 40013.87724073189,
                40050.928813854975, 40087.76074169493, 40124.39556859223, 40160.81359226663, 40197.023205582416,
                40233.01882090315, 40268.808628933526, 40304.38709119011, 40339.755542315565, 40374.92201931143,
                40409.88108570959, 40444.64067826247, 40479.19542705211, 40513.546623765076, 40547.71507012622,
                40581.68239926723, 40615.45630536012, 40649.03157956783, 40682.41582027462, 40715.6038822672,
                40748.59700005028, 40781.402629891825, 40814.01572099359, 40846.443636928416, 40878.68138849266,
                40910.730170547155, 40942.6032494155, 40974.28964909437, 41005.796507382765, 41037.11898514327,
                41068.26413161524, 41099.227166541605, 41130.009231764416, 41160.617245126035, 41191.04651374903,
                41221.303869769225, 41251.38467731638, 41281.29004164944, 41311.03788509455, 41340.61236885563,
                41370.02011765734, 41399.25663362789, 41428.32845958325, 41457.231152164655, 41485.96576792727,
                41514.53872815374, 41542.945670387104, 41571.1929366343, 41599.276217221646, 41627.19653493438,
                41654.970533900516, 41682.58349809551, 41710.041577668024, 41737.34059072547, 41764.48661164586,
                41791.47550901652, 41818.30826066153, 41844.99082852873, 41871.51915612509, 41897.89913205791,
                41924.12674871659, 41950.20295274843, 41976.14320550153, 42001.93383024264, 42027.58053807529,
                42053.0794397338, 42078.43617621634, 42103.64690501224, 42128.71253125763, 42153.638591922754,
                42178.4213138914, 42203.06616627155, 42227.5694212265, 42251.9319551061, 42276.16363499079,
                42300.25627375659, 42324.2151751874, 42348.03672179002, 42371.726152486284, 42395.27989308827,
                42418.69878143853, 42441.987960207516, 42465.143919484544, 42488.1717391483, 42511.06795123058,
                42533.8333669973, 42556.48133706616, 42579.00004029047, 42601.39440455924, 42623.661063460306,
                42645.804884847406, 42667.8225424357, 42689.71481210045, 42711.48647260308, 42733.1342572218,
                42754.66288659424, 42776.0691328668, 42797.35374736962, 42818.52914264822, 42839.58432266849,
                42860.52386736928, 42881.344643015414, 42902.05117396711, 42922.64036368021, 42943.11293079721,
                42963.47331719616, 42983.7184815401, 43003.85281189346, 43023.87330294676, 43043.7806506705,
                43063.58639887484, 43083.28031592434, 43102.86665961058, 43122.34251186965, 43141.71207902982,
                43160.97247750473, 43180.12437306972, 43199.17189567507, 43218.11221291617, 43236.949404910025,
                43255.68067265424, 43274.30666097948, 43292.83474219082, 43311.25878025045, 43329.5827338446,
                43347.803885391884, 43365.92614592595, 43383.946829828434, 43401.86655390477, 43419.68915846302,
                43437.412005336206, 43455.038888685005, 43472.56720131171, 43489.99754067419, 43507.33989838707,
                43524.585409338164, 43541.737755960115, 43558.794406062036, 43575.758997933815, 43592.62902902982,
                43609.40507103663, 43626.090696724794, 43642.683447561416, 43659.18685356472, 43675.598484928305,
                43691.91889546003, 43708.157386037805, 43724.30570001425, 43740.3672638928, 43756.33971744699,
                43772.22644627981, 43788.02511766717, 43803.73626160037, 43819.363202972716, 43834.90364989357,
                43850.360887640425, 43865.73265097548, 43881.01945336613, 43896.22995544497, 43911.356464774464,
                43926.40217070538, 43941.3648725619, 43956.24772179005, 43971.04854323485, 43985.767828350195,
                44000.40867231633, 44014.968937871745, 44029.45168347896, 44043.85479661167, 44058.17875344963,
                44072.429089251564, 44086.60118179604, 44100.69800005079, 44114.71749180156, 44128.6625908868,
                44142.53126877566, 44156.32398120395, 44170.043609861685, 44183.68816138522, 44197.260483432045,
                44210.75860559538, 44224.1829694929, 44237.541090267994, 44250.82628554292, 44264.04132055682,
                44277.1842805205, 44290.25789810164, 44303.26028049963, 44316.19185052061, 44329.05529247842,
                44341.84874622483, 44354.57486451592, 44367.23180851991, 44379.81998798836, 44392.34640758653,
                44404.80483534857, 44417.197847600204, 44429.52365715699, 44441.784810137455, 44453.97953977772,
                44466.10823843347, 44478.17340737699, 44490.173310170045, 44502.110418814875, 44513.983016671875,
                44525.79148402351, 44537.54235191328, 44549.229806447955, 44560.856248734955, 44572.420010108355,
                44583.92346365417, 44595.36495967605, 44606.744862366904, 44618.06550320935, 44629.32526067955,
                44640.52643910519, 44651.66743535642, 44662.74860245858, 44673.7741179875, 44684.74048135244,
                44695.649930675594, 44706.50090769158, 44717.29562452756, 44728.03254054127, 44738.71199380544,
                44749.336157850325, 44759.90351820805, 44770.41622321494, 44780.87277549353, 44791.27350278702,
                44801.62408750828, 44811.919465355146, 44822.16172363285, 44832.349406382236, 44842.48457678217,
                44852.56579525369, 44862.59337577171, 44872.56934569078, 44882.49228976182, 44892.36421195401,
                44902.183712905266, 44911.951097032295, 44921.67166797148, 44931.34069622383, 44940.96012910414,
                44950.528605755484, 44960.04805109475, 44969.51711949442, 44978.93610262981, 44988.306892158165,
                44997.62816507391, 45006.90179132184, 45016.12646266905, 45025.30246194474, 45034.434740984834,
                45043.51888139474, 45052.55670051371, 45061.54692591629, 45070.49135414287, 45079.388726931626,
                45088.23931531845, 45097.04488495683, 45105.80419862512, 45114.51900181214, 45123.1880710369,
                45131.81166914657, 45140.39296627731, 45148.929296416434, 45157.42235587477, 45165.870954697355,
                45174.27676987963, 45182.638624640495, 45190.95677085881, 45199.23285684446, 45207.465725387425,
                45215.65700606899, 45223.805554461185, 45231.91161486279, 45239.97950774173, 45248.005373432505,
                45255.990796132966, 45263.93466240292, 45271.838538493874, 45279.70132322505, 45287.52325078772,
                45295.30586077944, 45303.04807023321, 45310.75140134336, 45318.41478303924, 45326.03844249253,
                45333.6264178896, 45341.17509955663, 45348.68596751269, 45356.15797953033, 45363.592598949544,
                45370.98879495489, 45378.34678535691, 45385.66800872225, 45392.9514511914, 45400.198535154734,
                45407.40825782824, 45414.580830520514, 45421.720028940275, 45428.82247598376, 45435.88955483618,
                45442.92028956904, 45449.91604786171, 45456.87586441225, 45463.7999418575, 45470.68962484476,
                45473.493812278015, 45476.27886058817, 45479.04426902624, 45481.79017609057, 45484.51796445255,
                45487.22651673366
            ]
        },
        'eur': [1035539.3444639277, 384159.5034503926]
    },
    'phase': 'oil',
    'phaseType': 'rate',
    'TC_para_dict': {
        'b0': [-1.5, -0.5],
        'b': [0.001, 2],
        'b2': [0.001, 2],
        'buildup': {
            'apply_ratio': False,
            'apply': True,
            'buildup_ratio': 0.1,
            'days': 0
        },
        'D_lim_eff': 0.08,
        'D1_eff': [0, 99],
        'minus_t_elf_t_peak': [1, 5000],
        'q_final': 0.8,
        'q_peak': [0, 10000],
        'minus_t_peak_t0': [0, 1000],
        'minus_t_decline_t_0': [1, 300],
        'TC_model': 'exp_arps_modified_wp',
        'well_life': 60,
        'q_flat': 100,
        'D_eff': [1e-05, 0.99],
        'D': [2.7378645095978106e-08, 13.687885010266916]
    },
    'tcId': None,
    'basePhase': 'oil'
}
fit_results = [{
    'P_dict': {
        'best': {
            'segments': [{
                'name': 'arps_modified',
                'q_start': 73.5588982774173,
                'q_end': 0.13570963058825825,
                'slope': -1.0,
                'D_eff': 0.5273498586448097,
                'D': 0.003424917402687523,
                'b': 1.267822906209675,
                'target_D_eff_sw': 0.08,
                'realized_D_eff_sw': 0.07999999999999996,
                'sw_idx': 44327.796430480135,
                'q_sw': 8.688138595515861,
                'D_exp_eff': 0.07999999999999996,
                'D_exp': 0.0002282864036661219,
                'start_idx': 41103,
                'end_idx': 62547
            }],
            'diagnostics': {}
        }
    },
    'diagnostics': {},
    'forecastType': 'rate',
    'forecastSubType': 'automatic',
    'warning': {
        'status': False,
        'message': ''
    },
    'ratio': {
        'segments': [],
        'diagnostics': {},
        'basePhase': None,
        'x': None,
        'eur': None,
        'rur': None
    },
    'forecasted': True,
    'data_freq': None
}, {
    'P_dict': {
        'best': {
            'segments': [{
                'name': 'arps_modified',
                'q_start': 73.558897921709,
                'q_end': 0.1357096296572759,
                'slope': -1.0,
                'D_eff': 0.527349853977287,
                'D': 0.0034249173005566243,
                'b': 1.2678228844953787,
                'target_D_eff_sw': 0.08,
                'realized_D_eff_sw': 0.07999999999999996,
                'sw_idx': 44327.796478844546,
                'q_sw': 8.68813843998911,
                'D_exp_eff': 0.07999999999999996,
                'D_exp': 0.00022828640366612184,
                'start_idx': 41103,
                'end_idx': 62547
            }],
            'diagnostics': {}
        }
    },
    'diagnostics': {},
    'forecastType': 'rate',
    'forecastSubType': 'automatic',
    'warning': {
        'status': False,
        'message': ''
    },
    'ratio': {
        'segments': [],
        'diagnostics': {},
        'basePhase': None,
        'x': None,
        'eur': None,
        'rur': None
    },
    'forecasted': True,
    'data_freq': None
}]

proximity_fit_generation_cases = [
    ({
        'tc_segments': [{
            'name': 'arps_modified',
            'q_start': 433.64839957266145,
            'q_end': 0.8000447407990738,
            'slope': -1.0,
            'D_eff': 0.5273498586448097,
            'D': 0.003424917402687523,
            'b': 1.267822906209675,
            'target_D_eff_sw': 0.08,
            'realized_D_eff_sw': 0.07999999999999996,
            'sw_idx': 7090.80726766163,
            'q_sw': 51.21878502043283,
            'D_exp_eff': 0.07999999999999996,
            'D_exp': 0.0002282864036661219,
            'start_idx': 3866.0,
            'end_idx': 25310.0
        }],
        'target_bg_info': {
            'forecastId': '61e8285c1a90230013802949',
            'wellId': '5faad44907b5d658e827be12',
            'target_bg_data': {
                'index': [
                    41073, 41103, 41134, 41165, 41195, 41226, 41256, 41287, 41318, 41346, 41377, 41407, 41438, 41468,
                    41499, 41530, 41560, 41591, 41621, 41652, 41683, 41711, 41742, 41772, 41803, 41833, 41864, 41895,
                    41925, 41956, 41986, 42017, 42048, 42076, 42107, 42137, 42168, 42198, 42229, 42260, 42290, 42321,
                    42351, 42382, 42413, 42442, 42473, 42503, 42534, 42564, 42595, 42626, 42656, 42687, 42717, 42748,
                    42779, 42807, 42838, 42868, 42899, 42929, 42960, 42991, 43021, 43052, 43082, 43113, 43144, 43172,
                    43203, 43233, 43264, 43294, 43325, 43356, 43386, 43417, 43447, 43478, 43509, 43537, 43568, 43598,
                    43629, 43659, 43690, 43721, 43751, 43782, 43812, 43843, 43874, 43903, 43934, 43964, 43995, 44025,
                    44056, 44087, 44117, 44148, 44178
                ],
                'value': [
                    20.829568788501028, 310.80082135523617, 187.86036960985626, 114.92402464065708, 101.74948665297741,
                    85.12525667351129, 73.03490759753593, 60.05749486652977, 34.26694045174538, 27.301848049281315,
                    83.38398357289527, 66.92402464065708, 41.69199178644764, 55.45790554414784, 43.827515400410675,
                    36.40246406570842, 36.96098562628337, 27.82751540041068, 35.5482546201232, 30.455852156057496,
                    24.772073921971252, 30.652977412731005, 22.702258726899384, 26.02053388090349, 17.248459958932237,
                    22.86652977412731, 20.53388090349076, 25.560574948665298, 20.829568788501028, 16.591375770020534,
                    35.61396303901437, 23.983572895277206, 16.39425051334702, 24.476386036960985, 23.786447638603697,
                    26.546201232032853, 21.35523613963039, 20.73100616016427, 14.817248459958932, 21.782340862423,
                    20.10677618069815, 18.135523613963038, 15.967145790554415, 18.661190965092402, 15.93429158110883,
                    16.854209445585216, 15.80287474332649, 16.55852156057495, 15.474332648870636, 14.751540041067761,
                    15.507186858316222, 14.193018480492814, 15.638603696098563, 15.047227926078028, 14.48870636550308,
                    13.995893223819301, 11.958932238193018, 9.82340862422998, 13.371663244353183, 14.850102669404517,
                    19.28542094455852, 6.242299794661191, 8.837782340862423, 11.991786447638603, 11.630390143737166,
                    10.480492813141684, 9.13347022587269, 15.868583162217659, 11.958932238193018, 3.252566735112936,
                    2.1683778234086244, 10.184804928131417, 1.215605749486653, 7.063655030800821, 12.517453798767967,
                    5.979466119096509, 18.858316221765914, 6.012320328542095, 12.386036960985626, 7.62217659137577,
                    14.48870636550308, 13.634496919917865, 8.870636550308008, 9.626283367556468, 12.91170431211499,
                    9.13347022587269, 9.593429158110883, 9.626283367556468, 9.69199178644764, 10.447638603696099,
                    11.236139630390143, 7.852156057494867, 8.640657084188911, 5.158110882956879, 9.987679671457906,
                    8.640657084188911, 1.2484599589322383, 0, 0, 0, 4.501026694045175, 2.595482546201232,
                    5.585215605749487
                ]
            },
            'resolution': 'monthly'
        },
        'phaseType':
        'rate',
        'basePhase':
        'oil',
        'TC_para_dict': {
            'b0': [-1.5, -0.5],
            'b': [0.001, 2],
            'b2': [0.001, 2],
            'buildup': {
                'apply_ratio': False,
                'apply': True,
                'buildup_ratio': 0.1,
                'days': 0
            },
            'D_lim_eff': 0.08,
            'D1_eff': [0, 99],
            'minus_t_elf_t_peak': [1, 5000],
            'q_final': 0.8,
            'q_peak': [0, 10000],
            'minus_t_peak_t0': [0, 1000],
            'minus_t_decline_t_0': [1, 300],
            'TC_model': 'exp_arps_modified_wp',
            'well_life': 60,
            'q_flat': 100,
            'D_eff': [1e-05, 0.99],
            'D': [2.7378645095978106e-08, 13.687885010266916]
        },
        'initial_fit_params':
        initial_fit_params
    }, fit_results[0]),
    ({
        'tc_segments': [{
            'name': 'arps_modified',
            'q_start': 433.64839957266145,
            'q_end': 0.8000447391794753,
            'slope': -1.0,
            'D_eff': 0.527349853977287,
            'D': 0.0034249173005566243,
            'b': 1.2678228844953787,
            'target_D_eff_sw': 0.08,
            'realized_D_eff_sw': 0.07999999999999996,
            'sw_idx': 7090.807316026157,
            'q_sw': 51.21878435124147,
            'D_exp_eff': 0.07999999999999996,
            'D_exp': 0.00022828640366612184,
            'start_idx': 3866.0,
            'end_idx': 25310.0
        }],
        'target_bg_info': {
            'forecastId': '61e8285c1a90230013802949',
            'wellId': '5faad44907b5d658e827be12',
            'target_bg_data': {
                'index': [
                    41073, 41103, 41134, 41165, 41195, 41226, 41256, 41287, 41318, 41346, 41377, 41407, 41438, 41468,
                    41499, 41530, 41560, 41591, 41621, 41652, 41683, 41711, 41742, 41772, 41803, 41833, 41864, 41895,
                    41925, 41956, 41986, 42017, 42048, 42076, 42107, 42137, 42168, 42198, 42229, 42260, 42290, 42321,
                    42351, 42382, 42413, 42442, 42473, 42503, 42534, 42564, 42595, 42626, 42656, 42687, 42717, 42748,
                    42779, 42807, 42838, 42868, 42899, 42929, 42960, 42991, 43021, 43052, 43082, 43113, 43144, 43172,
                    43203, 43233, 43264, 43294, 43325, 43356, 43386, 43417, 43447, 43478, 43509, 43537, 43568, 43598,
                    43629, 43659, 43690, 43721, 43751, 43782, 43812, 43843, 43874, 43903, 43934, 43964, 43995, 44025,
                    44056, 44087, 44117, 44148, 44178
                ],
                'value': [
                    20.829568788501028, 310.80082135523617, 187.86036960985626, 114.92402464065708, 101.74948665297741,
                    85.12525667351129, 73.03490759753593, 60.05749486652977, 34.26694045174538, 27.301848049281315,
                    83.38398357289527, 66.92402464065708, 41.69199178644764, 55.45790554414784, 43.827515400410675,
                    36.40246406570842, 36.96098562628337, 27.82751540041068, 35.5482546201232, 30.455852156057496,
                    24.772073921971252, 30.652977412731005, 22.702258726899384, 26.02053388090349, 17.248459958932237,
                    22.86652977412731, 20.53388090349076, 25.560574948665298, 20.829568788501028, 16.591375770020534,
                    35.61396303901437, 23.983572895277206, 16.39425051334702, 24.476386036960985, 23.786447638603697,
                    26.546201232032853, 21.35523613963039, 20.73100616016427, 14.817248459958932, 21.782340862423,
                    20.10677618069815, 18.135523613963038, 15.967145790554415, 18.661190965092402, 15.93429158110883,
                    16.854209445585216, 15.80287474332649, 16.55852156057495, 15.474332648870636, 14.751540041067761,
                    15.507186858316222, 14.193018480492814, 15.638603696098563, 15.047227926078028, 14.48870636550308,
                    13.995893223819301, 11.958932238193018, 9.82340862422998, 13.371663244353183, 14.850102669404517,
                    19.28542094455852, 6.242299794661191, 8.837782340862423, 11.991786447638603, 11.630390143737166,
                    10.480492813141684, 9.13347022587269, 15.868583162217659, 11.958932238193018, 3.252566735112936,
                    2.1683778234086244, 10.184804928131417, 1.215605749486653, 7.063655030800821, 12.517453798767967,
                    5.979466119096509, 18.858316221765914, 6.012320328542095, 12.386036960985626, 7.62217659137577,
                    14.48870636550308, 13.634496919917865, 8.870636550308008, 9.626283367556468, 12.91170431211499,
                    9.13347022587269, 9.593429158110883, 9.626283367556468, 9.69199178644764, 10.447638603696099,
                    11.236139630390143, 7.852156057494867, 8.640657084188911, 5.158110882956879, 9.987679671457906,
                    8.640657084188911, 1.2484599589322383, 0, 0, 0, 4.501026694045175, 2.595482546201232,
                    5.585215605749487
                ]
            },
            'resolution': 'monthly'
        },
        'phaseType':
        'rate',
        'basePhase':
        'oil',
        'TC_para_dict': {
            'b0': [-1.5, -0.5],
            'b': [0.001, 2],
            'b2': [0.001, 2],
            'buildup': {
                'apply_ratio': False,
                'apply': True,
                'buildup_ratio': 0.1,
                'days': 0
            },
            'D_lim_eff': 0.08,
            'D1_eff': [0, 99],
            'minus_t_elf_t_peak': [1, 5000],
            'q_final': 0.8,
            'q_peak': [0, 10000],
            'minus_t_peak_t0': [0, 1000],
            'minus_t_decline_t_0': [1, 300],
            'TC_model': 'exp_arps_modified_wp',
            'well_life': 60,
            'q_flat': 100,
            'D_eff': [1e-05, 0.99],
            'D': [2.7378645095978106e-08, 13.687885010266916]
        },
        'initial_fit_params':
        initial_fit_params
    }, fit_results[1])
]


@pytest.mark.unittest
@pytest.mark.python_apis
@pytest.mark.parametrize("test_input,expected", proximity_fit_generation_cases)
def test_proximity_fit_generation(test_input, expected):
    context = MockContext()
    proximity_forecast_service = ProximityForecastService(context)

    ret = proximity_forecast_service.apply_TC_fit(**test_input)['P_dict']['best']['segments']
    expected_segments = expected['P_dict']['best']['segments']

    for i in range(len(expected_segments)):
        for key in expected_segments[i]:
            if type(expected_segments[i][key]) == float or type(expected_segments[i][key]) == int:
                assert isclose(ret[i][key], expected_segments[i][key])
            else:
                assert (ret[i][key] == expected_segments[i][key])


target_well_header_dict_list = [{
    '5e61a382bc3de5d21ee18a07': {
        '_id': ObjectId('5e61a382bc3de5d21ee18a07'),
        'surfaceLatitude': 30.5873086,
        'surfaceLongitude': -96.2447907,
        'completion_end_date': datetime(2015, 3, 18, 0, 0),
        'first_prod_date': datetime(2015, 4, 1, 0, 0),
        'first_prod_date_daily_calc': None,
        'first_prod_date_monthly_calc': datetime(2015, 4, 15, 0, 0),
        'last_prod_date_daily': None,
        'spud_date': datetime(2015, 1, 19, 0, 0),
        'createdAt': datetime(2020, 3, 6, 1, 12, 34, 445000)
    }
}, {
    '5e61a37ebc3de5d21ee175ae': {
        '_id': ObjectId('5e61a37ebc3de5d21ee175ae'),
        'surfaceLatitude': 30.5873086,
        'surfaceLongitude': -96.2447907,
        'completion_end_date': datetime(2017, 5, 9, 0, 0),
        'first_prod_date': datetime(2017, 5, 1, 0, 0),
        'first_prod_date_daily_calc': None,
        'first_prod_date_monthly_calc': datetime(2017, 5, 15, 0, 0),
        'last_prod_date_monthly': datetime(2019, 11, 15, 0, 0),
        'last_prod_date_daily': None,
        'spud_date': datetime(2017, 1, 1, 0, 0),
        'createdAt': datetime(2020, 3, 6, 1, 12, 30, 72000)
    }
}]

candidate_well_headers = [{
    '_id': '5e61a37ebc3de5d21ee175ae',
    'completion_end_date': '05/09/2017 00:00:00 ',
    'first_prod_date': '05/01/2017 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '05/15/2017 00:00:00 ',
    'last_prod_date_monthly': '11/15/2019 00:00:00 ',
    'last_prod_date_daily': None,
    'spud_date': '01/01/2017 00:00:00 ',
    'createdAt': '03/06/2020 01:12:30 ',
    'surfaceLatitude': 30.5873086,
    'surfaceLongitude': -96.2447907
}, {
    '_id': '5e61a382bc3de5d21ee18a07',
    'completion_end_date': '03/18/2015 00:00:00 ',
    'first_prod_date': '04/01/2015 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '04/15/2015 00:00:00 ',
    'last_prod_date_daily': None,
    'spud_date': '01/19/2015 00:00:00 ',
    'createdAt': '03/06/2020 01:12:34 ',
    'surfaceLatitude': 32.4717127,
    'surfaceLongitude': -102.3981478
}, {
    '_id': '5e7271c3f4321168a1e9d830',
    'completion_end_date': '06/07/2017 00:00:00 ',
    'first_prod_date': '06/01/2017 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '06/15/2017 00:00:00 ',
    'last_prod_date_daily': None,
    'spud_date': '03/21/2017 00:00:00 ',
    'createdAt': '03/18/2020 19:08:51 ',
    'surfaceLatitude': 32.2832689,
    'surfaceLongitude': -103.4856767
}, {
    '_id': '5e7271c5f4321168a1e9ddde',
    'completion_end_date': '09/13/2014 00:00:00 ',
    'first_prod_date': '09/01/2014 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '09/15/2014 00:00:00 ',
    'last_prod_date_daily': None,
    'spud_date': '07/02/2014 00:00:00 ',
    'createdAt': '03/18/2020 19:08:52 ',
    'surfaceLatitude': 32.2819824,
    'surfaceLongitude': -103.4899139
}, {
    '_id': '5ea75f6fa89f032e0f9b0613',
    'completion_end_date': '06/07/2017 00:00:00 ',
    'first_prod_date': '06/01/2017 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '06/15/2017 00:00:00 ',
    'last_prod_date_daily': None,
    'spud_date': '03/21/2017 00:00:00 ',
    'econ_run_date': '11/17/2021 17:32:31 ',
    'econ_first_production_date': '06/01/2017 00:00:00 ',
    'createdAt': '04/27/2020 22:40:46 ',
    'surfaceLatitude': 32.2832689,
    'surfaceLongitude': -103.4856767
}, {
    '_id': '5ea75f71a89f032e0f9b1301',
    'completion_end_date': '09/13/2014 00:00:00 ',
    'first_prod_date': '09/01/2014 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '09/15/2014 00:00:00 ',
    'last_prod_date_daily': None,
    'spud_date': '07/02/2014 00:00:00 ',
    'econ_run_date': '11/17/2021 17:32:31 ',
    'econ_first_production_date': '09/01/2014 00:00:00 ',
    'createdAt': '04/27/2020 22:40:49 ',
    'surfaceLatitude': 32.2819824,
    'surfaceLongitude': -103.4899139
}, {
    '_id': '5ea76886a89f032e0fa0e5c7',
    'completion_end_date': '05/09/2017 00:00:00 ',
    'first_prod_date': '05/01/2017 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '05/15/2017 00:00:00 ',
    'last_prod_date_monthly': '11/15/2019 00:00:00 ',
    'last_prod_date_daily': None,
    'spud_date': '01/01/2017 00:00:00 ',
    'createdAt': '04/27/2020 23:19:34 ',
    'surfaceLatitude': 30.5873086,
    'surfaceLongitude': -96.2447907
}, {
    '_id': '5ea7688fa89f032e0fa10502',
    'completion_end_date': '03/18/2015 00:00:00 ',
    'first_prod_date': '04/01/2015 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '04/15/2015 00:00:00 ',
    'spud_date': '01/19/2015 00:00:00 ',
    'createdAt': '04/27/2020 23:19:43 ',
    'surfaceLatitude': 32.4717127,
    'surfaceLongitude': -102.3981478
}, {
    '_id': '5ea76921a89f032e0fa2f253',
    'completion_end_date': '12/06/2014 00:00:00 ',
    'first_prod_date': '12/01/2014 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '12/15/2014 00:00:00 ',
    'last_prod_date_monthly': '12/15/2019 00:00:00 ',
    'last_prod_date_daily': None,
    'spud_date': '08/22/2014 00:00:00 ',
    'createdAt': '04/27/2020 23:22:09 ',
    'surfaceLatitude': 31.1272358,
    'surfaceLongitude': -103.4401103
}, {
    '_id': '5eab478e394ebe4976c828fd',
    'completion_end_date': '07/19/2013 00:00:00 ',
    'first_prod_date': '08/01/2013 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '08/15/2013 00:00:00 ',
    'spud_date': '11/05/2012 00:00:00 ',
    'createdAt': '04/30/2020 21:47:58 ',
    'updatedAt': '05/01/2020 16:23:32 ',
    'surfaceLatitude': 31.747399,
    'surfaceLongitude': -101.7606346
}, {
    '_id': '5eab478e394ebe4976c82910',
    'first_prod_date': '05/01/2013 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '05/15/2013 00:00:00 ',
    'last_prod_date_monthly': '02/15/2020 00:00:00 ',
    'spud_date': '04/08/2012 00:00:00 ',
    'econ_run_date': '03/28/2022 17:19:06 ',
    'econ_first_production_date': '05/01/2013 00:00:00 ',
    'createdAt': '04/30/2020 21:47:58 ',
    'updatedAt': '05/01/2020 16:23:38 ',
    'surfaceLatitude': 31.742938,
    'surfaceLongitude': -101.7589013
}, {
    '_id': '5eab47d8394ebe4976c82c11',
    'first_prod_date': '06/01/1984 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '06/15/1984 00:00:00 ',
    'last_prod_date_monthly': '02/15/2017 00:00:00 ',
    'econ_run_date': '03/28/2022 17:19:06 ',
    'econ_first_production_date': '06/01/1984 00:00:00 ',
    'createdAt': '04/30/2020 21:49:12 ',
    'updatedAt': '05/01/2020 16:24:35 ',
    'surfaceLatitude': 31.7483371,
    'surfaceLongitude': -101.7558671
}, {
    '_id': '5eab47d8394ebe4976c82c12',
    'completion_end_date': '11/16/1983 00:00:00 ',
    'first_prod_date': '01/01/1953 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '01/15/1953 00:00:00 ',
    'last_prod_date_monthly': '08/15/2003 00:00:00 ',
    'econ_run_date': '03/28/2022 17:19:06 ',
    'econ_first_production_date': '01/01/1953 00:00:00 ',
    'createdAt': '04/30/2020 21:49:12 ',
    'updatedAt': '05/01/2020 16:24:36 ',
    'surfaceLatitude': 31.744711,
    'surfaceLongitude': -101.7547445
}, {
    '_id': '5ed67b56c3629ac71ded82cb',
    'completion_end_date': '07/21/2011 00:00:00 ',
    'first_prod_date': '07/01/2011 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '07/15/2011 00:00:00 ',
    'mostRecentImportDate': '06/02/2020 22:45:06 ',
    'last_prod_date_monthly': '12/01/2019 00:00:00 ',
    'spud_date': '02/24/2011 00:00:00 ',
    'createdAt': '06/02/2020 16:16:16 ',
    'surfaceLatitude': 48.2565901,
    'surfaceLongitude': -103.4978479
}, {
    '_id': '5f329b7883ac87c2407f2168',
    'completion_end_date': '03/18/2015 00:00:00 ',
    'first_prod_date': '04/01/2015 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '04/15/2015 00:00:00 ',
    'mostRecentImportDate': '08/11/2020 13:05:17 ',
    'last_prod_date_monthly': '12/01/2019 00:00:00 ',
    'last_prod_date_daily': None,
    'spud_date': '01/19/2015 00:00:00 ',
    'createdAt': '08/11/2020 13:21:59 ',
    'updatedAt': '08/11/2020 13:21:59 ',
    'surfaceLatitude': 32.4717127,
    'surfaceLongitude': -102.3981478
}, {
    '_id': '5f329bab83ac87c2407f7e22',
    'completion_end_date': '05/09/2017 00:00:00 ',
    'first_prod_date': '05/01/2017 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '05/15/2017 00:00:00 ',
    'mostRecentImportDate': '08/11/2020 13:05:17 ',
    'last_prod_date_monthly': '11/15/2019 00:00:00 ',
    'last_prod_date_daily': None,
    'spud_date': '01/01/2017 00:00:00 ',
    'createdAt': '08/11/2020 13:22:50 ',
    'updatedAt': '08/11/2020 13:22:50 ',
    'surfaceLatitude': 30.5873086,
    'surfaceLongitude': -96.2447907
}, {
    '_id': '5f329cb483ac87c240819d4b',
    'completion_end_date': '12/06/2014 00:00:00 ',
    'first_prod_date': '12/01/2014 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '12/15/2014 00:00:00 ',
    'mostRecentImportDate': '08/11/2020 13:05:17 ',
    'last_prod_date_monthly': '12/15/2019 00:00:00 ',
    'last_prod_date_daily': None,
    'spud_date': '08/22/2014 00:00:00 ',
    'createdAt': '08/11/2020 13:27:16 ',
    'updatedAt': '08/11/2020 13:27:16 ',
    'surfaceLatitude': 31.1272358,
    'surfaceLongitude': -103.4401103
}, {
    '_id': '5faad45307b5d658e827ce6a',
    'completion_start_date': '12/14/2013 00:00:00 ',
    'date_rig_release': '09/08/2013 00:00:00 ',
    'first_prod_date': '01/01/2014 00:00:00 ',
    'first_prod_date_daily_calc': '01/01/2014 00:00:00 ',
    'first_prod_date_monthly_calc': '01/15/2014 00:00:00 ',
    'mostRecentImportDate': '03/01/2021 15:04:24 ',
    'last_prod_date_monthly': '11/15/2020 00:00:00 ',
    'last_prod_date_daily': '11/01/2020 00:00:00 ',
    'permit_date': '11/17/2012 00:00:00 ',
    'spud_date': '07/21/2013 00:00:00 ',
    'createdAt': '11/10/2020 17:56:34 ',
    'updatedAt': '03/01/2021 15:43:47 ',
    'surfaceLatitude': 40.237498,
    'surfaceLongitude': -104.799289
}, {
    '_id': '5faad48a07b5d658e8280aca',
    'completion_start_date': '12/03/2013 00:00:00 ',
    'date_rig_release': '08/11/2013 00:00:00 ',
    'first_prod_date': '12/01/2013 00:00:00 ',
    'first_prod_date_daily_calc': '12/01/2013 00:00:00 ',
    'first_prod_date_monthly_calc': '12/15/2013 00:00:00 ',
    'mostRecentImportDate': '03/01/2021 15:04:33 ',
    'last_prod_date_monthly': '12/15/2020 00:00:00 ',
    'last_prod_date_daily': '12/01/2020 00:00:00 ',
    'permit_date': '05/17/2013 00:00:00 ',
    'spud_date': '07/22/2013 00:00:00 ',
    'createdAt': '11/10/2020 17:57:29 ',
    'updatedAt': '03/01/2021 15:45:32 ',
    'surfaceLatitude': 40.238004,
    'surfaceLongitude': -104.79392
}, {
    '_id': '6147535c7909b29a139d72c8',
    'completion_end_date': '07/21/2011 00:00:00 ',
    'first_prod_date': '07/01/2011 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '07/01/2011 00:00:00 ',
    'mostRecentImportDate': '09/19/2021 14:53:50 ',
    'last_prod_date_monthly': '12/01/2019 00:00:00 ',
    'last_prod_date_daily': None,
    'spud_date': '02/24/2011 00:00:00 ',
    'createdAt': '09/19/2021 15:12:28 ',
    'updatedAt': '09/19/2021 15:12:28 ',
    'surfaceLatitude': 48.2565901,
    'surfaceLongitude': -103.4978479
}, {
    '_id': '6351560a0c83328b4ab9e29b',
    'completion_end_date': '03/18/2015 00:00:00 ',
    'first_prod_date': '04/01/2015 00:00:00 ',
    'first_prod_date_daily_calc': None,
    'first_prod_date_monthly_calc': '04/15/2015 00:00:00 ',
    'mostRecentImportDate': '10/20/2022 14:01:12 ',
    'last_prod_date_monthly': '12/15/2019 00:00:00 ',
    'last_prod_date_daily': None,
    'spud_date': '01/19/2015 00:00:00 ',
    'createdAt': '10/20/2022 14:07:06 ',
    'updatedAt': '10/20/2022 14:09:33 ',
    'surfaceLatitude': 32.4717127,
    'surfaceLongitude': -102.3981478
}]
candidate_well_data = {
    'well_headers':
    candidate_well_headers,
    'well_forecast_pairs': [{
        '_id': '63c734eadc737200134cd963',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ea75f6fa89f032e0f9b0613'
    }, {
        '_id': '63c734eadc737200134cd956',
        'forecast': '63c734eadc737200134cd954',
        'well': '5e61a37ebc3de5d21ee175ae'
    }, {
        '_id': '63c734eadc737200134cd974',
        'forecast': '63c734eadc737200134cd954',
        'well': '5eab478e394ebe4976c82910'
    }, {
        '_id': '63c734eadc737200134cd971',
        'forecast': '63c734eadc737200134cd954',
        'well': '5eab478e394ebe4976c828fd'
    }, {
        '_id': '63c734eadc737200134cd96d',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ea7688fa89f032e0fa10502'
    }, {
        '_id': '63c734eadc737200134cd95d',
        'forecast': '63c734eadc737200134cd954',
        'well': '5e7271c3f4321168a1e9d830'
    }, {
        '_id': '63c734eadc737200134cd96f',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ea76921a89f032e0fa2f253'
    }, {
        '_id': '63c734eadc737200134cd95a',
        'forecast': '63c734eadc737200134cd954',
        'well': '5e61a382bc3de5d21ee18a07'
    }, {
        '_id': '63c734eadc737200134cd967',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ea75f71a89f032e0f9b1301'
    }, {
        '_id': '63c734eadc737200134cd959',
        'forecast': '63c734eadc737200134cd954',
        'well': '5e61a382bc3de5d21ee18a07'
    }, {
        '_id': '63c734eadc737200134cd958',
        'forecast': '63c734eadc737200134cd954',
        'well': '5e61a37ebc3de5d21ee175ae'
    }, {
        '_id': '63c734eadc737200134cd97a',
        'forecast': '63c734eadc737200134cd954',
        'well': '5eab47d8394ebe4976c82c12'
    }, {
        '_id': '63c734eadc737200134cd983',
        'forecast': '63c734eadc737200134cd954',
        'well': '5f329bab83ac87c2407f7e22'
    }, {
        '_id': '63c734eadc737200134cd988',
        'forecast': '63c734eadc737200134cd954',
        'well': '5f329cb483ac87c240819d4b'
    }, {
        '_id': '63c734eadc737200134cd960',
        'forecast': '63c734eadc737200134cd954',
        'well': '5e7271c5f4321168a1e9ddde'
    }, {
        '_id': '63c734eadc737200134cd96a',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ea76886a89f032e0fa0e5c7'
    }, {
        '_id': '63c734eadc737200134cd98b',
        'forecast': '63c734eadc737200134cd954',
        'well': '5faad45307b5d658e827ce6a'
    }, {
        '_id': '63c734eadc737200134cd962',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ea75f6fa89f032e0f9b0613'
    }, {
        '_id': '63c734eadc737200134cd969',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ea76886a89f032e0fa0e5c7'
    }, {
        '_id': '63c734eadc737200134cd96e',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ea76921a89f032e0fa2f253'
    }, {
        '_id': '63c734eadc737200134cd98a',
        'forecast': '63c734eadc737200134cd954',
        'well': '5faad45307b5d658e827ce6a'
    }, {
        '_id': '63c734eadc737200134cd961',
        'forecast': '63c734eadc737200134cd954',
        'well': '5e7271c5f4321168a1e9ddde'
    }, {
        '_id': '63c734eadc737200134cd975',
        'forecast': '63c734eadc737200134cd954',
        'well': '5eab478e394ebe4976c82910'
    }, {
        '_id': '63c734eadc737200134cd980',
        'forecast': '63c734eadc737200134cd954',
        'well': '5f329b7883ac87c2407f2168'
    }, {
        '_id': '63c734eadc737200134cd993',
        'forecast': '63c734eadc737200134cd954',
        'well': '6351560a0c83328b4ab9e29b'
    }, {
        '_id': '63c734eadc737200134cd957',
        'forecast': '63c734eadc737200134cd954',
        'well': '5e61a37ebc3de5d21ee175ae'
    }, {
        '_id': '63c734eadc737200134cd95e',
        'forecast': '63c734eadc737200134cd954',
        'well': '5e7271c3f4321168a1e9d830'
    }, {
        '_id': '63c734eadc737200134cd972',
        'forecast': '63c734eadc737200134cd954',
        'well': '5eab478e394ebe4976c828fd'
    }, {
        '_id': '63c734eadc737200134cd98d',
        'forecast': '63c734eadc737200134cd954',
        'well': '5faad48a07b5d658e8280aca'
    }, {
        '_id': '63c734eadc737200134cd95b',
        'forecast': '63c734eadc737200134cd954',
        'well': '5e61a382bc3de5d21ee18a07'
    }, {
        '_id': '63c734eadc737200134cd95c',
        'forecast': '63c734eadc737200134cd954',
        'well': '5e7271c3f4321168a1e9d830'
    }, {
        '_id': '63c734eadc737200134cd986',
        'forecast': '63c734eadc737200134cd954',
        'well': '5f329cb483ac87c240819d4b'
    }, {
        '_id': '63c734eadc737200134cd96c',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ea7688fa89f032e0fa10502'
    }, {
        '_id': '63c734eadc737200134cd976',
        'forecast': '63c734eadc737200134cd954',
        'well': '5eab478e394ebe4976c82910'
    }, {
        '_id': '63c734eadc737200134cd95f',
        'forecast': '63c734eadc737200134cd954',
        'well': '5e7271c5f4321168a1e9ddde'
    }, {
        '_id': '63c734eadc737200134cd968',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ea76886a89f032e0fa0e5c7'
    }, {
        '_id': '63c734eadc737200134cd970',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ea76921a89f032e0fa2f253'
    }, {
        '_id': '63c734eadc737200134cd985',
        'forecast': '63c734eadc737200134cd954',
        'well': '5f329bab83ac87c2407f7e22'
    }, {
        '_id': '63c734eadc737200134cd989',
        'forecast': '63c734eadc737200134cd954',
        'well': '5faad45307b5d658e827ce6a'
    }, {
        '_id': '63c734eadc737200134cd994',
        'forecast': '63c734eadc737200134cd954',
        'well': '6351560a0c83328b4ab9e29b'
    }, {
        '_id': '63c734eadc737200134cd978',
        'forecast': '63c734eadc737200134cd954',
        'well': '5eab47d8394ebe4976c82c11'
    }, {
        '_id': '63c734eadc737200134cd97c',
        'forecast': '63c734eadc737200134cd954',
        'well': '5eab47d8394ebe4976c82c12'
    }, {
        '_id': '63c734eadc737200134cd981',
        'forecast': '63c734eadc737200134cd954',
        'well': '5f329b7883ac87c2407f2168'
    }, {
        '_id': '63c734eadc737200134cd982',
        'forecast': '63c734eadc737200134cd954',
        'well': '5f329b7883ac87c2407f2168'
    }, {
        '_id': '63c734eadc737200134cd990',
        'forecast': '63c734eadc737200134cd954',
        'well': '6147535c7909b29a139d72c8'
    }, {
        '_id': '63c734eadc737200134cd964',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ea75f6fa89f032e0f9b0613'
    }, {
        '_id': '63c734eadc737200134cd965',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ea75f71a89f032e0f9b1301'
    }, {
        '_id': '63c734eadc737200134cd966',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ea75f71a89f032e0f9b1301'
    }, {
        '_id': '63c734eadc737200134cd979',
        'forecast': '63c734eadc737200134cd954',
        'well': '5eab47d8394ebe4976c82c11'
    }, {
        '_id': '63c734eadc737200134cd97b',
        'forecast': '63c734eadc737200134cd954',
        'well': '5eab47d8394ebe4976c82c12'
    }, {
        '_id': '63c734eadc737200134cd987',
        'forecast': '63c734eadc737200134cd954',
        'well': '5f329cb483ac87c240819d4b'
    }, {
        '_id': '63c734eadc737200134cd98f',
        'forecast': '63c734eadc737200134cd954',
        'well': '6147535c7909b29a139d72c8'
    }, {
        '_id': '63c734eadc737200134cd96b',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ea7688fa89f032e0fa10502'
    }, {
        '_id': '63c734eadc737200134cd977',
        'forecast': '63c734eadc737200134cd954',
        'well': '5eab47d8394ebe4976c82c11'
    }, {
        '_id': '63c734eadc737200134cd97e',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ed67b56c3629ac71ded82cb'
    }, {
        '_id': '63c734eadc737200134cd97f',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ed67b56c3629ac71ded82cb'
    }, {
        '_id': '63c734eadc737200134cd973',
        'forecast': '63c734eadc737200134cd954',
        'well': '5eab478e394ebe4976c828fd'
    }, {
        '_id': '63c734eadc737200134cd991',
        'forecast': '63c734eadc737200134cd954',
        'well': '6147535c7909b29a139d72c8'
    }, {
        '_id': '63c734eadc737200134cd992',
        'forecast': '63c734eadc737200134cd954',
        'well': '6351560a0c83328b4ab9e29b'
    }, {
        '_id': '63c734eadc737200134cd97d',
        'forecast': '63c734eadc737200134cd954',
        'well': '5ed67b56c3629ac71ded82cb'
    }, {
        '_id': '63c734eadc737200134cd98c',
        'forecast': '63c734eadc737200134cd954',
        'well': '5faad48a07b5d658e8280aca'
    }, {
        '_id': '63c734eadc737200134cd98e',
        'forecast': '63c734eadc737200134cd954',
        'well': '5faad48a07b5d658e8280aca'
    }, {
        '_id': '63c734eadc737200134cd984',
        'forecast': '63c734eadc737200134cd954',
        'well': '5f329bab83ac87c2407f7e22'
    }, {
        '_id': '63c734fcdc737200134cdadf',
        'forecast': '63c734fcdc737200134cdadd',
        'well': '5e61a37ebc3de5d21ee175ae'
    }, {
        '_id': '63c734fcdc737200134cdae0',
        'forecast': '63c734fcdc737200134cdadd',
        'well': '5e61a37ebc3de5d21ee175ae'
    }, {
        '_id': '63c734fcdc737200134cdae3',
        'forecast': '63c734fcdc737200134cdadd',
        'well': '5e61a382bc3de5d21ee18a07'
    }, {
        '_id': '63c734fcdc737200134cdae1',
        'forecast': '63c734fcdc737200134cdadd',
        'well': '5e61a37ebc3de5d21ee175ae'
    }, {
        '_id': '63c734fcdc737200134cdae2',
        'forecast': '63c734fcdc737200134cdadd',
        'well': '5e61a382bc3de5d21ee18a07'
    }, {
        '_id': '63c734fcdc737200134cdae4',
        'forecast': '63c734fcdc737200134cdadd',
        'well': '5e61a382bc3de5d21ee18a07'
    }]
}

neighbor_well_return_list = []
neighbor_well_case_0 = ([{
    'target_well_id': '5e61a382bc3de5d21ee18a07',
    'proximity_forecast_id': '63c734fcdc737200134cdadd',
    'neighbor_dict': {
        'selectedFields': [],
        'selectedForecasts': ['63c734fcdc737200134cdadd', '63c734eadc737200134cd954'],
        'searchRadius': 1000,
        'wellCountRange': {
            'start': 1,
            'end': 8
        },
        'forecastSearch': ''
    },
    'phase': 'oil',
    'phase_type': 'rate',
    'base_phase': None,
    'num_month': 720
}, candidate_well_data, target_well_header_dict_list[0]], [[
    '5f329bab83ac87c2407f7e22', '5ea76886a89f032e0fa0e5c7', '5eab478e394ebe4976c82910', '5eab478e394ebe4976c828fd',
    '5f329b7883ac87c2407f2168'
], {
    '5eab478e394ebe4976c82910': '63c734eadc737200134cd954',
    '5eab478e394ebe4976c828fd': '63c734eadc737200134cd954',
    '5f329bab83ac87c2407f7e22': '63c734eadc737200134cd954',
    '5ea76886a89f032e0fa0e5c7': '63c734eadc737200134cd954',
    '5f329b7883ac87c2407f2168': '63c734eadc737200134cd954'
}, {
    '63c734eadc737200134cd954': [
        '5eab478e394ebe4976c82910', '5eab478e394ebe4976c828fd', '5f329bab83ac87c2407f7e22', '5ea76886a89f032e0fa0e5c7',
        '5f329b7883ac87c2407f2168'
    ]
}, 5])
neighbor_well_case_1 = ([{
    'target_well_id': '5e61a37ebc3de5d21ee175ae',
    'proximity_forecast_id': '63c734fcdc737200134cdadd',
    'neighbor_dict': {
        'selectedFields': [],
        'selectedForecasts': ['63c734fcdc737200134cdadd', '63c734eadc737200134cd954'],
        'searchRadius': 300,
        'wellCountRange': {
            'start': 1,
            'end': 5
        },
        'forecastSearch': ''
    },
    'phase': 'oil',
    'phase_type': 'rate',
    'base_phase': None,
    'num_month': 720
}, candidate_well_data, target_well_header_dict_list[1]], [['5ea76886a89f032e0fa0e5c7', '5f329bab83ac87c2407f7e22'], {
    '5f329bab83ac87c2407f7e22': '63c734eadc737200134cd954',
    '5ea76886a89f032e0fa0e5c7': '63c734eadc737200134cd954'
}, {
    '63c734eadc737200134cd954': ['5f329bab83ac87c2407f7e22', '5ea76886a89f032e0fa0e5c7']
}, 2])
get_neighbor_wells_cases = [neighbor_well_case_0, neighbor_well_case_1]


@pytest.mark.unittest
@pytest.mark.python_apis
@pytest.mark.parametrize("test_input,expected", get_neighbor_wells_cases)
def test_get_neighbor_wells(test_input, expected):
    context = MockContext()
    proximity_forecast_service = ProximityForecastService(context)

    ret = list(proximity_forecast_service.get_neighbor_wells(test_input[0], test_input[1], test_input[2]))

    assert sorted(expected[0]) == sorted(ret[0])
    assert sorted(expected[1]) == sorted(ret[1])
    assert expected[3] == len(ret[3])

    for key in expected[2]:
        assert sorted(expected[2][key]) == sorted(ret[2][key])
