/*
All of the code within the ZingChart software is developed and copyrighted by ZingChart, Inc., and may not be copied,
replicated, or used in any other software or application without prior permission from ZingChart. All usage must coincide with the
ZingChart End User License Agreement which can be requested by email at support@zingchart.com.

Build 2.9.11pre
*/
ZC.A87={},ZC.WG.push("export"),ZC.AQ.A3W=function(e,t,n,a){"jpg"===(a=a||"png")&&(a="jpeg");for(var o=document.createElement("canvas"),i=(o.width=t,o.height=n,o.style.width=t+"px",o.style.height=n+"px",o.getContext("2d")),r=0,s=(e=e instanceof Array?e:[e]).length;r<s;r++)if(-1===e[r].className.indexOf("zc-no-print")){var l=!1;try{e[r].toDataURL("image/"+a)}catch(c){l=!0}l||((l=e[r].getAttribute("data-clip"))?(l=l.split(","),i.drawImage(e[r],ZC.BQ(0,l[0]),ZC.BQ(0,l[1]),ZC.CY(l[2],e[r].width),ZC.CY(l[3],e[r].height),ZC.BQ(0,l[0]),ZC.BQ(0,l[1]),ZC.CY(l[2],e[r].width),ZC.CY(l[3],e[r].height))):i.drawImage(e[r],0,0,e[r].width,e[r].height,0,0,t,n))}return o.toDataURL("image/"+a)},ZC.AQ.ABN=function(e,t,n,a,o){null===ZC._n_(o)&&(o=!1);e=ZC.AQ.A3W(e,t,n,a);if(o)return(t=document.createElement("img")).src=e,t;e=e.replace("image/"+a,"image/octet-stream"),document.location.href=e},ZC.Q3.prototype.AA5=function(){var n=this,a=[];if(!n.A7O){n.A7O=!0;var o=document.body.childNodes,i=ZC.A5(document.body).css(ZC._[0]),r=ZC.A5(document.body).css("background-image");ZC.A5(document.body).css(ZC._[0],"#fff").css("background-image","none");for(var e=0,t=o.length;e<t;e++)1===o[e].nodeType&&(a[e]=o[e].style.display,o[e].style.display="none");document.body.appendChild(ZC.AL(n.L+"-wrapper")),window.setTimeout(function(){window.print(),window.setTimeout(function(){ZC.A5(document.body).css(ZC._[0],i).css("background-image",r),ZC.AL(n.L+"-wrapper")&&ZC.AL(n.L).appendChild(ZC.AL(n.L+"-wrapper"));for(var e=0,t=o.length;e<t;e++)1===o[e].nodeType&&(o[e].style.display=a[e]);n.A7O=!1},1e3)},50)}},ZC.Q3.prototype.OG=function(s,l,c,d){var p=this;if(l=l||{},typeof c===ZC._[31]&&(c=!1),!ZC.AL(p.L+"-viewimage")){s=s||"png";var h,e,u,n,g=l.download,C=l.fn||"",t=(ZC.Q.IV(ZC.AL(p.L+"-guide-c"),p.AC,0,0,p.I,p.F),ZC.A5(".zc-guide-label").remove(),("canvas"===p.AC||zingchart.AJAXEXPORT||zingchart.DEV.LOCALSVGEXPORT)&&"pdf"!==s&&"svg"!==s);if(ZC.mobile||!t||c||g||(h=ZC.Q.I1({cls:"zc-abs zc-viewimage zc-style",id:p.L+"-viewimage",zidx:5,p:ZC.AL(p.L+"-top"),wh:p.I+"/"+p.F}),e=ZC.Q.I1({id:p.L+"-viewimage-close",p:h,zidx:10,tl:"5/"+(p.I-15),html:ZC.HK["viewimage-close"]}),ZC.A5(e).css("cursor","pointer").css("left",p.I-15-ZC.A5(e).width()+"px"),ZC.A5(e).bind("click",function(){ZC.A5(h).remove()})),ZC.mobile&&(g=!0),!zingchart.DEV.LOCALSVGEXPORT||g||"svg"!==p.AC||"png"!==s&&"jpeg"!==s){if("canvas"===p.AC&&"pdf"!==s&&"svg"!==s){var a,o,i=document.createElement("canvas");for(i.width=p.I,i.height=p.F,a=0,o=p.AG.length;a<o;a++)p.AG[a].BE&&p.AG[a].BE.EM(i);var r=[],m=(ZC.A5("#"+p.L+" canvas").each(function(){-1===ZC.AV([p.L+"-guide-c",p.L+"-trigger-c"],this.id)&&r.push(this)}),r.push(i),r.push(p.createPreviewMasks()),ZC.AQ.ABN(r,p.I,p.F,s,!0));m.id=p.L+"-print-"+s,h.appendChild(m)}else c||p.A8G(ZC.HK["export-wait"]),"vml"===p.AC||"canvas"===p.AC&&("pdf"===s||"svg"===s)?(m=document.createElement("div"),n="zc-export-svg-"+p.L,m.id=n,m.style.display="none",document.body.appendChild(m),zingchart.render({id:n,output:"!svg",imggen:!0,width:p.I,height:p.F,data:p.D.json,defaults:p.MM,theme:p.LJ,hideprogresslogo:!0,events:{load:function(){window.setTimeout(function(){var e,t=zingchart.getLoader(n);t.D["dynamic-objects"]?e=window.setInterval(function(){"ready"===t.D["dynamic-objects"]&&(window.clearInterval(e),t.togglePreviewMasks(!0),u=ZC.AL(n+"-top").innerHTML,t.togglePreviewMasks(!1),zingchart.exec(n,"destroy",{skipfs:!0}),f())},100):(t.togglePreviewMasks(!0),u=ZC.AL(n+"-top").innerHTML,t.togglePreviewMasks(!1),zingchart.exec(n,"destroy",{skipfs:!0}),f())},100)}}})):"svg"===p.AC&&(p.togglePreviewMasks(!0),u=ZC.AL(p.L+"-top").innerHTML,f(),p.togglePreviewMasks(!1));t&&!c&&(ZC.A5(e).css("cursor","pointer").css("left",p.I-15-ZC.A5(e).width()+"px"),ZC.A5(e).bind("click",function(){ZC.A5(h).remove()}))}else zingchart.exec(p.L,"getimagedata",{callback:function(e){var t;-1!==e?((t=document.createElement("img")).id=p.L+"-print-"+s,t.src=e,h.appendChild(t)):(ZC.Q.EU(p.L+"-viewimage"),zingchart.DEV.LOCALSVGEXPORT=0,p.OG(s,l,c,d))}})}function f(){var e,t={svg:u=(u=u.replace(/<foreignObject(.+?)<\/foreignObject>/g,"")).replace(' xmlns="http://www.w3.org/2000/svg"',""),w:p.I,h:p.F,t:s,fn:C};if(ZC._cp_(l,t),zingchart.AJAXEXPORT&&"pdf"!==s&&"svg"!==s&&!g){var n="base64=1&";for(e in t)n+=e+"="+encodeURIComponent(t[e])+"&";ZC.A5.ajax({type:"post",url:zingchart.EXPORTURL,data:n,success:function(e,t,n){p.A48(),c?d&&d(e,t,n):((t=document.createElement("img")).src=e,t.id=p.L+"-print-"+s,h.appendChild(t))}})}else{ZC.AL(p.L+"-export")&&ZC.Q.EU(p.L+"-export");var a,o=ZC.Q.I1({cls:"zc-abs zc-style",id:p.L+"-export",p:ZC.AL(p.L+"-top"),display:"none"}),i=(a=null!==ZC._n_(t.uid)&&null!==ZC._n_(t.page)?ZC.Q.ABB(ZC.AL(p.L+"-export")):document).createElement("FORM");for(e in i.action=zingchart.EXPORTURL,i.method="post",i.enctype="multipart/form-data",(null!==ZC._n_(t.uid)&&null!==ZC._n_(t.page)?a.body:o).appendChild(i),i.style.display="none",t){var r=a.createElement("INPUT");r.type="hidden",r.name=e,r.value=t[e],i.appendChild(r)}i.submit(),(i=null)!==ZC._n_(t.uid)&&null!==ZC._n_(t.page)&&window.setTimeout(function(){ZC.A5("#"+p.L+"-export").remove()},6e4),window.setTimeout(function(){p.A48()},1e3)}}},ZC.Q3.prototype.Z6=function(e){var t,n,a=this,o=(e=e||"png",[]),i=document.createElement("canvas");for(i.width=a.I,i.height=a.F,t=0,n=a.AG.length;t<n;t++)a.AG[t].BE&&a.AG[t].BE.EM(i);return ZC.A5("#"+a.L+" canvas").each(function(){-1===ZC.AV([a.L+"-guide-c",a.L+"-tooltip-c"],this.id)&&o.push(this)}),o.push(i),o.push(a.createPreviewMasks()),ZC.AQ.A3W(o,a.I,a.F,e)},ZC.AQ.downloadFile=function(e,t,n){var a;ZC.ie678||(n=n||"application/octet-stream",a=document.createElement("a"),navigator.msSaveBlob?navigator.msSaveBlob(new Blob([e],{type:n}),t):URL&&"download"in a?(a.href=URL.createObjectURL(new Blob([e],{type:n})),a.setAttribute("download",t),document.body.appendChild(a),a.click(),document.body.removeChild(a)):location.href="data:application/octet-stream,"+encodeURIComponent(e))},ZC.AQ.XW=function(e,t){var n,a,o,i,r,s,l,c,d,p=[],h="",u=[];for("xls"===(t=t||"csv")&&p.push('<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">',"<head>","\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>[ZC]</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e",'<style>td{border:none;font-family:Calibri,sans-serif} .number{mso-number-format:"0.00";} .text{mso-number-format:"@";}</style>',"<meta name=ProgId content=Excel.Sheet>","<meta charset=UTF-8>","</head>","<body>"),n=0,a=e.AG.length;n<a;n++){var g=e.AG[n],C=g.AZ.A3,m=(e.D.fastlinedata&&(C=e.D.fastlinedata),{}),f=[],A=g.BW("k")[0],Z=("html"!==t&&"xls"!==t&&"raw"!==t||(p.push("<table>"),g.IR&&""!==g.IR.AM&&(u.push([g.IR.AM]),p.push("<caption>"+g.IR.AM+"</caption>")),p.push("<thead>"),p.push("<tr>")),l=[],"Category"),v=!(d=[]),w="%Y-%mm-%dd %H:%i:%s";for(A&&(A.F6&&"date"===A.F6.o.type&&(Z="Date",v=!0,A.F6.o["export-format"]&&(w=A.F6.o["export-format"])),A.M&&A.M.AM&&(Z=A.M.AM.replace(/\"|\'/g,""))),"csv"===t?l.push('"'+Z+'"'):"raw"===t?d.push(Z):"html"!==t&&"xls"!==t||l.push("<th>"+Z+"</th>"),b=0,L=C.length;b<L;b++)null!==ZC._n_(C[b].o["export"])&&!ZC._b_(C[b].o["export"])||(c=(c=null!==ZC._n_(C[b].AM)?C[b].AM+"":"Series "+b).replace(/\"|\'/g,""),"csv"===t?l.push('"'+c+'"'):"raw"===t?d.push(c):"html"!==t&&"xls"!==t||l.push("<th"+("xls"===t?' scope="col" class="text"':"")+">"+c+"</th>"),f.push(""));if("csv"===t?p.push(l.join(",")):"raw"===t?u.push(d):"html"!==t&&"xls"!==t||p.push(l.join("")),"html"!==t&&"xls"!==t||(p.push("</tr>"),p.push("</thead>"),p.push("<tbody>")),A){for(r=0,s=A.V.length;r<s;r++)m[r+""]={hasData:!1,nodes:[].concat(f)};for(var x=[],b=0,L=C.length;b<L;b++)if(null===ZC._n_(C[b].o["export"])||ZC._b_(C[b].o["export"]))for(o=0,i=C[b].S.length;o<i;o++){var y=C[b].S[o];y&&(m[r=null!==ZC._n_(y.BV)?""+y.BV:""+o]=m[r]||{hasData:!0,nodes:[].concat(f)},m[r].nodes[b]=y.AD,m[r].hasData=!0,null!==ZC._n_(y.BV)&&x.push(""+y.BV))}var _=[];for(r in m)m[r].hasData&&_.push([r,m[r].nodes]);_.sort(function(e,t){return e[0]-t[0]});for(var k=null,E=0,O=_.length;E<O;E++){if("html"!==t&&"xls"!==t||p.push("<tr>"),"pie"!==g.AF&&"pie3d"!==g.AF&&"nestedpie"!==g.AF||A.V[_[E][0]]&&(_[E][0]=A.V[_[E][0]]),A.BY[_[E][0]]&&(_[E][0]=A.BY[_[E][0]]),A.V[_[E][0]]&&-1===ZC.AV(x,_[E][0])&&(_[E][0]=A.V[_[E][0]]),(k=g.A.FF()).row=E,k.col=0,k[ZC._[9]]=_[E][0],_[E][0]=ZC.AQ.C0("dataexport",g.A,k,_[E][0],null),ZC._n_(_[E][1]))for(var R=0;R<_[E][1].length;R++)(k=g.A.FF()).row=E,k.col=R+1,k[ZC._[9]]=_[E][1][R],_[E][1][R]=ZC.AQ.C0("dataexport",g.A,k,_[E][1][R],null);v&&(_[E][0]=ZC.AQ.YE(_[E][0],w,g.UF,g.NB),"csv"===t&&(_[E][0]='"'+_[E][0]+'"')),"csv"===t?p.push([].concat(_[E][0]).concat(_[E][1]).join(",")):"raw"===t?u.push([].concat(_[E][0]).concat(_[E][1])):"html"!==t&&"xls"!==t||p.push("<td"+("xls"===t?' scope="row"':"")+">"+[].concat(_[E][0]).concat(_[E][1]).join("</td><td>")+"</td>"),"html"!==t&&"xls"!==t||p.push("</tr>")}}"html"!==t&&"xls"!==t||(p.push("</tbody>"),p.push("</table>")),1<a&&n<a-1&&("csv"===t?p.push("","",""):"html"!==t&&"xls"!==t||p.push("<p>&nbsp;</p>"))}return"xls"===t&&p.push("</body>","</html>"),"raw"===t?u:("csv"===t?h=p.join("\n"):"html"!==t&&"xls"!==t||(h=p.join("")),h)},zingchart.ABD=function(e,t,i){var n,a,o="",r="";function s(e){ZC.A5.ajax({type:"post",url:n,data:e,success:function(e,t,n){a&&a(e,t,n)}})}document.getElementById("zc-fullscreen")&&(e="zc-fullscreen"),"string"==typeof(i=i||{})&&(i=JSON.parse(i));var l,c=zingchart.getLoader(e);if(c)switch(t){case"getimagedata":var d,p,h,u,g="png";if(null!==ZC._n_(l=i.format)&&(g=l),"jpg"===(g=null!==ZC._n_(l=i.filetype)?l:g)&&(g="jpeg"),!zingchart.DEV.LOCALSVGEXPORT||"svg"!==c.AC||"png"!==g&&"jpeg"!==g||(c.togglePreviewMasks(!0),m=(d=ZC.AL(c.L+"-svg").parentNode.innerHTML).indexOf(">"),C=d.indexOf("</svg>"),d=(d='<svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+c.I+'" height="'+c.F+'">[CSS]'+d.substring(m+1,C+6)).replace(/<foreignObject(.+?)<\/foreignObject>/g,""),p=function(){var a,e=window.URL||window.webkitURL||window,t=!1,o=(navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(t=!0),a=e.createObjectURL&&window.Blob&&!t?e.createObjectURL(new window.Blob([d],{type:"image/svg+xml;charset-utf-16"})):"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(d),c.togglePreviewMasks(!1),new window.Image);o.crossOrigin="anonymous",o.src=a,o.onload=function(){var e=document.createElement("canvas"),t=e.getContext("2d");if(e.width=o.width,e.height=o.height,t.drawImage(o,0,0,e.width,e.height),i.callback&&"function"==typeof i.callback)try{i.callback(e.toDataURL("image/"+g))}catch(n){i.callback(a)}}},h=0,u=function(){var e=new XMLHttpRequest;e.open("get",c.A27[h]),e.responseType="text",e.onloadend=function(e){var a=e.target.response,o=a.match(/https?:\/\/[^ \)]+/g),i=0;o.forEach(function(n){var e=new XMLHttpRequest;e.open("get",n),e.responseType="blob",e.onloadend=function(e){var t=new FileReader;t.onloadend=function(e){a=a.replace(new RegExp(n),e.target.result),++i===o.length&&(d=d.replace("[CSS]","[CSS]<style><![CDATA["+a+"]]></style>"),(++h===c.A27.length?(d=d.replace("[CSS]",""),p):u)())},t.readAsDataURL(e.target.response)},e.send()})},e.send()},(c.A27.length?u:(d=d.replace("[CSS]",""),p))()),"canvas"!==c.AC&&!zingchart.AJAXEXPORT)return-1;if("canvas"===c.AC){if(!i.callback||"function"!=typeof i.callback)return c.Z6(g);try{i.callback(c.Z6(g))}catch(f){i.callback(-1)}}else c.OG(g,{},!0,i.callback);break;case"exportimage":case"saveasimage":if(!i.download&&"canvas"!==c.AC&&!zingchart.AJAXEXPORT)return-1;if(g="png",m={},null!==ZC._n_(l=i.options)&&(m=l),null!==ZC._n_(l=i.uid)&&(m.uid=l),null!==ZC._n_(l=i.page)&&(m.page=l),null!==ZC._n_(l=i.format)&&(g=l),null!==ZC._n_(l=i.filetype)&&(g=l),null!==ZC._n_(l=i.filename)&&(o=l),n=c.D.exportimageurl||"",null!==ZC._n_(l=i.url)&&(n=l),(a=null)!==ZC._n_(l=i.callback)&&(a=l),"jpg"===g&&(g="jpeg"),i.download&&("canvas"!==c.AC||"pdf"===g))return m.download=!0,""!==o&&(m.fn=o),void c.OG(g,m);if(""!==n){if("canvas"===c.AC)return s(c.Z6(g));c.OG(g,m,!0,s)}break;case"exportdata":if(n=c.D.exportdataurl||"",null!==ZC._n_(l=i.url)&&(n=l),r=ZC.AQ.XW(c,"csv"),""===n)return r;(a=null)!==ZC._n_(l=i.callback)&&(a=l),ZC.A5.ajax({type:"post",url:n,data:r,success:function(e,t,n){a&&a(e,t,n)}});break;case"downloadCSV":r=ZC.AQ.XW(c,"csv"),ZC.AQ.downloadFile(r,(i.fn||c.L)+".csv","text/csv;encoding:utf-8");break;case"downloadXLS":var r=ZC.AQ.XW(c,"xls"),C=i.sn||"ZingChart";r=r.replace("<x:Name>[ZC]</x:Name>","<x:Name>"+C+"</x:Name>"),ZC.AQ.downloadFile(r,(i.fn||c.L)+".xls","application/vnd.ms-excel;encoding:utf-8");break;case"downloadRAW":var m=ZC.AQ.XW(c,"raw");if(!i.callback||"function"!=typeof i.callback)return m;try{i.callback(m,i.fn||c.L)}catch(f){i.callback(-1)}break;case"viewDataTable":"viewdatatable"===i.menuid?(r=ZC.AQ.XW(c,"html"),ZC.AL(c.L+"-data-table")?ZC.AL(c.L+"-data-table").innerHTML=r:(l=ZC.Q.I1({id:c.L+"-data-table",cls:"zc-data-table "+c.L+"-data-table"}),ZC.Q.PJ(l,{width:c.I+"px","max-height":"400px",overflow:"auto"}),l.innerHTML=r,ZC.AL(c.L).parentNode.insertBefore(l,ZC.AL(c.L).nextSibling))):"hidedatatable"===i.menuid&&ZC.Q.EU(c.L+"-data-table")}return null};