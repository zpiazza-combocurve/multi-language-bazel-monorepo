/*
All of the code within the ZingChart software is developed and copyrighted by ZingChart, Inc., and may not be copied,
replicated, or used in any other software or application without prior permission from ZingChart. All usage must coincide with the
ZingChart End User License Agreement which can be requested by email at support@zingchart.com.

Build 2.9.11pre_ES6
*/
zingchart.setModule("bubble-legend"),zingchart.plugins.bubblelegend={},zingchart.plugins.bubblelegend.info={},zingchart.bind(null,"complete",function(e){var n=zingchart.getLoader(e.id),i=zingchart.getModules(n);if(-1!==ZC.AV(i,"bubble-legend"))for(var t=0,a=n.AG.length;t<a;t++){var l=!1,r={},o=n.AG[t];if(o.o["bubble-legend"])for(var d=0,g=o.AZ.A3.length;d<g;d++){var b=o.AZ.A3[d];"bubble"!==b.AF&&"hbubble"!==b.AF||(l=!0,r["g"+b.A1W]=r["g"+b.A1W]||{min:Number.MAX_VALUE,max:-Number.MAX_VALUE,maxSize:0,graphid:t,plotindex:b.K,color:"-1"!==b.A2.A0?b.A2.A0:b.BP[1]},r["g"+b.A1W].max=Math.max(r["g"+b.A1W].max,b.XA),r["g"+b.A1W].min=Math.min(r["g"+b.A1W].min,b.RY))}if(l){var c=o.o["bubble-legend"]||{},h=c.layout||"v";null===ZC._n_(c.margin)&&(c.margin="v"===h?"auto 10 auto auto":"auto auto 10 auto");var u,p,s,x,z,_,m,f=[],A=0,v=Number.MAX_VALUE,Z=0,y=0,C=zingchart.getInstance(o,"textbox");for(p in r)for(Z++,s=r[p],z=(x=ZC.AP.X2(s.min,s.max))[3],A=Math.max(A,zingchart.exec(n.L,"getbubblesize",{graphid:s[ZC._[3]],plotindex:s.plotindex,value:x[1]})),v=Math.min(v,zingchart.exec(n.L,"getbubblesize",{graphid:s[ZC._[3]],plotindex:s.plotindex,value:0===x[0]?x[0]+x[2]:x[0]})),u=x[0];u<=x[1];u+=x[2])u>0&&(_={decimals:z,short:!0,"thousands-separator":",","decimals-separator":"."},ZC._cp_(c.item,_),m=zingchart.formatNumber(x[1],_),C.append({"font-size":10,text:m}),C.append(c.item),C.parse(),y=Math.max(y,C.I));var L=ZC._i_(c.padding||5),M=zingchart.getInstance(o,"box");M.append({id:o.L+"-bubblelegend-box"}),"v"===h?M.append({width:2*L+2*A+10+y,height:2*L+2*A*Z+10*(Z-1)+5}):M.append({width:2*L+2*A*Z+10*(Z-1)+Z*y,height:2*L+2*A+30}),M.append(o.o["bubble-legend"]),M.parse();var X={type:"rect",x:M.iX+M.I/2,y:M.iY+M.F/2,width:M.I,height:M.F,"background-color":"#fff"};ZC._cp_(o.o["bubble-legend"],X),f.push(X);var w=0;for(p in r){s=r[p],z=(x=ZC.AP.X2(s.min,s.max))[3];var V=[];for(u=x[0];u<=x[1];u+=x[2])u>0&&V.push(u);var W=[];for(A<15?W.push(V[V.length-1]):A>=15&&A<25?W.push(V[0],V[V.length-1]):A-v>=10?W.push(V[0],V[Math.floor(V.length/2.5)],V[V.length-1]):W.push(V[0],V[V.length-1]),u=0;u<W.length;u++){var I=zingchart.exec(n.L,"getbubblesize",{graphid:s[ZC._[3]],plotindex:s.plotindex,value:W[u]});_={decimals:z,short:!0,"thousands-separator":",","decimals-separator":"."},ZC._cp_(c.item,_),m=zingchart.formatNumber(W[u],_);var N,F,Y=n.L+"_"+s[ZC._[3]];Z>1&&(Y+="_"+s.plotindex),"h"===h?(N=M.iX+w*(10+2*A+y)+L,F=M.iY+A+L+15):(N=M.iX+A+L,F=M.iY+L+2*A+w*(10+2*A)+5),zingchart.plugins.bubblelegend.info[Y]={x:N,y:F,layout:h};var j={id:o.L+"-bubblelegend-circle_"+w+"_"+u,type:"circle",size:I,alpha:.25,"background-color":Z>1?s.color:"#999","line-style":"dotted","border-width":1,"border-alpha":1,"border-color":"#333"};if("h"===h){var k=F+(u%2==0?-1:1)*(A+10);u===W.length-1&&3===W.length&&(k=F-A/2-5),ZC._cp_({x:N+I,y:F,connector:{"line-width":1,"line-style":"dotted","line-color":"#333",anchor:"l",points:[[N+2*I,F],[N+2*I,k]]}},j)}else ZC._cp_({x:N,y:F-I,connector:{"line-width":1,"line-style":"dotted","line-color":"#333",anchor:"l",points:[[N,F-2*I],[N+A+10,F-2*I]]}},j);ZC._cp_({label:{color:"#666","font-size":10,align:"left",text:m}},j),ZC._cp_(c.marker,j),ZC._cp_(c.connector,j.connector),ZC._cp_(c.item,j.label),f.push(j)}w++}zingchart.exec(n.L,"addobject",{type:"shape",data:f})}}}),zingchart.bind(null,"node_mouseout",function(e){var n=zingchart.getLoader(e.id),i=zingchart.getModules(n);-1!==ZC.AV(i,"bubble-legend")&&zingchart.exec(e.id,"removeobject",{type:"shape",dynamic:!0,id:e.id+"_"+e.graphindex+"-bubblelegend-circle"})}),zingchart.bind(null,"node_mouseover",function(e){var n=zingchart.getLoader(e.id),i=zingchart.getModules(n);if(-1!==ZC.AV(i,"bubble-legend")&&null!==ZC._n_(e.size)){var t=e.id+"_"+e.graphindex;zingchart.plugins.bubblelegend.info[t]||(t+="_"+e.plotindex);var a={id:e.id+"_"+e.graphindex+"-bubblelegend-circle",type:"circle",size:e.size,"border-width":1,"border-color":"#333"};"h"===zingchart.plugins.bubblelegend.info[t].layout?(a.x=zingchart.plugins.bubblelegend.info[t].x+e.size,a.y=zingchart.plugins.bubblelegend.info[t].y):(a.x=zingchart.plugins.bubblelegend.info[t].x,a.y=zingchart.plugins.bubblelegend.info[t].y-e.size),zingchart.exec(e.id,"addobject",{type:"shape",dynamic:!0,data:a})}});