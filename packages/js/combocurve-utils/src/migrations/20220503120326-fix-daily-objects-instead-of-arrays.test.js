jest.setTimeout(30000);
// eslint-disable-next-line @typescript-eslint/no-var-requires -- TODO eslint fix later
const { ObjectId } = require('mongodb');

// eslint-disable-next-line @typescript-eslint/no-var-requires -- TODO eslint fix later
const setupDb = require('../../tests/setup-db');
// eslint-disable-next-line @typescript-eslint/no-var-requires -- TODO eslint fix later
const { up } = require('./20220503120326-fix-daily-objects-instead-of-arrays');

let db;
let client;
let mongod;

const dailyBefore = [
	{
		_id: new ObjectId('111111111111111111111111'),
		well: new ObjectId('555555555555555555555555'),
		startIndex: 43615,
		first_production_index: 0,
		project: new ObjectId('999999999999999999999999'),
		index: [
			43615,
			43616,
			43617,
			43618,
			43619,
			43620,
			43621,
			43622,
			43623,
			43624,
			43625,
			43626,
			43627,
			43628,
			43629,
			43630,
			43631,
			43632,
			43633,
			43634,
			43635,
			43636,
			43637,
			43638,
			43639,
			43640,
			43641,
			43642,
			43643,
			43644,
			null,
		],
		oil: [
			280.249068395265,
			315.99476082292,
			286.147313414554,
			346.730229426423,
			236.163647072905,
			354.026514205506,
			198.065516279611,
			313.018922425363,
			146.499321811914,
			332.086984438688,
			325.083201150773,
			332.370391894909,
			287.564797401174,
			282.291451477733,
			247.475471859223,
			295.18070554782,
			281.249946484871,
			290.847542043569,
			391.397898333532,
			168.549495406342,
			308.721229679278,
			285.523844877531,
			245.997976290557,
			318.675549517488,
			281.089056785315,
			239.346152671884,
			287.599106117346,
			305.770964434703,
			252.992515008778,
			259.484931803216,
			null,
		],
		gas: [
			602.050192283726,
			569.830044698813,
			565.995252619364,
			614.362566996157,
			598.97176566766,
			568.77595730254,
			556.541901514068,
			574.765773129343,
			251.690955573274,
			562.924110804213,
			567.296968161249,
			552.123888002018,
			519.521912821623,
			527.107287430286,
			452.985040889514,
			508.37583339643,
			561.388275516509,
			560.601948814161,
			551.998904233571,
			324.909690264567,
			560.647478573047,
			544.613547631684,
			564.964412956877,
			555.961028309021,
			545.30012455507,
			582.614177427939,
			556.109836905496,
			574.345649397553,
			563.871341742169,
			545.360286540297,
			null,
		],
		choke: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		water: [
			1344.53940268009,
			1536.04950595551,
			1459.06286698473,
			1615.34363464021,
			1249.51813245715,
			1615.5103312335,
			854.347887196968,
			1428.36644504614,
			804.308959471791,
			1469.61574965098,
			1480.35302492688,
			1560.52903299094,
			1249.9055525155,
			1361.54416979235,
			1246.66450377314,
			1213.01794004699,
			1299.62113635998,
			1363.44699603584,
			1345.40053260025,
			848.199461842086,
			1304.34564414438,
			1254.33008239979,
			1199.60389717344,
			1161.70755129939,
			1118.84709428683,
			1340.46493460128,
			1283.58164016667,
			1126.40122783241,
			1196.36004322005,
			1053.19086814071,
			null,
		],
		hours_on: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		gas_lift_injection_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		bottom_hole_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		tubing_head_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		flowline_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		casing_head_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		vessel_separator_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		operational_tag: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		gasInjection: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		waterInjection: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		co2Injection: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		steamInjection: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		ngl: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		customNumber0: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		customNumber1: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		customNumber2: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		customNumber3: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		customNumber4: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
	},
	{
		_id: new ObjectId('222222222222222222222222'),
		well: new ObjectId('666666666666666666666666'),
		startIndex: 44011,
		first_production_index: 0,
		project: null,
		index: [
			44011, 44012, 44013, 44014, 44015, 44016, 44017, 44018, 44019, 44020, 44021, 44022, 44023, 44024, 44025,
			44026, 44027, 44028, 44029, 44030, 44031, 44032, 44033, 44034, 44035, 44036, 44037, 44038, 44039, 44040,
			44041,
		],
		water: [
			48.19,
			36.84,
			36.84,
			0.75,
			22.84,
			15.75,
			29.81,
			30.75,
			41.23,
			40.42,
			36.71,
			53.0200004577637,
			46.76,
			49.46,
			35.93,
			100.22,
			49.63,
			59.62,
			7.38,
			48.86,
			29.43,
			38.71,
			13.7,
			null,
			45.32,
			51.65,
			30.96,
			55.46,
			40.52,
			38.57,
			36.61,
		],
		oil: [
			56.61, 135.87, 86.98, 7.23, 74.6, 61.24, 82.63, 73.28, 89.29, 84.6, 84.88, 96.1500015258789, 57.59, 68.24,
			83.84, 100.07, 70.3, 75.84, 53.37, 56.57, 88.77, 17.27, 24.98, 48.61, 73.29, 97.61, 72.18, 68.17, 71.26,
			66.85, 63.48,
		],
		gas: [
			707.93, 656.49, 640.4, 71.4, 877.56, 757.62, 645.31, 552.74, 551.57, 616.14, 618.03, 612.830017089844,
			607.25, 547.86, 599.29, 596.01, 590.37, 588.17, 486.89, 556.95, 582.49, 342.35, 412.07, 465.42, 559.6,
			602.8, 581.17, 572.23, 565.54, 556.98, 552.19,
		],
		choke: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		hours_on: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		gas_lift_injection_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		bottom_hole_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		tubing_head_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		flowline_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		casing_head_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		operational_tag: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		vessel_separator_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		customNumber0: {
			11: 0,
		},
		customNumber2: {
			11: 88.35,
		},
		customNumber3: {
			11: 40,
		},
		gasInjection: {
			11: 121,
		},
	},
];
const dailyAfter = [
	{
		_id: new ObjectId('111111111111111111111111'),
		well: new ObjectId('555555555555555555555555'),
		startIndex: 43615,
		first_production_index: 0,
		project: new ObjectId('999999999999999999999999'),
		index: [
			43615,
			43616,
			43617,
			43618,
			43619,
			43620,
			43621,
			43622,
			43623,
			43624,
			43625,
			43626,
			43627,
			43628,
			43629,
			43630,
			43631,
			43632,
			43633,
			43634,
			43635,
			43636,
			43637,
			43638,
			43639,
			43640,
			43641,
			43642,
			43643,
			43644,
			null,
		],
		oil: [
			280.249068395265,
			315.99476082292,
			286.147313414554,
			346.730229426423,
			236.163647072905,
			354.026514205506,
			198.065516279611,
			313.018922425363,
			146.499321811914,
			332.086984438688,
			325.083201150773,
			332.370391894909,
			287.564797401174,
			282.291451477733,
			247.475471859223,
			295.18070554782,
			281.249946484871,
			290.847542043569,
			391.397898333532,
			168.549495406342,
			308.721229679278,
			285.523844877531,
			245.997976290557,
			318.675549517488,
			281.089056785315,
			239.346152671884,
			287.599106117346,
			305.770964434703,
			252.992515008778,
			259.484931803216,
			null,
		],
		gas: [
			602.050192283726,
			569.830044698813,
			565.995252619364,
			614.362566996157,
			598.97176566766,
			568.77595730254,
			556.541901514068,
			574.765773129343,
			251.690955573274,
			562.924110804213,
			567.296968161249,
			552.123888002018,
			519.521912821623,
			527.107287430286,
			452.985040889514,
			508.37583339643,
			561.388275516509,
			560.601948814161,
			551.998904233571,
			324.909690264567,
			560.647478573047,
			544.613547631684,
			564.964412956877,
			555.961028309021,
			545.30012455507,
			582.614177427939,
			556.109836905496,
			574.345649397553,
			563.871341742169,
			545.360286540297,
			null,
		],
		choke: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		water: [
			1344.53940268009,
			1536.04950595551,
			1459.06286698473,
			1615.34363464021,
			1249.51813245715,
			1615.5103312335,
			854.347887196968,
			1428.36644504614,
			804.308959471791,
			1469.61574965098,
			1480.35302492688,
			1560.52903299094,
			1249.9055525155,
			1361.54416979235,
			1246.66450377314,
			1213.01794004699,
			1299.62113635998,
			1363.44699603584,
			1345.40053260025,
			848.199461842086,
			1304.34564414438,
			1254.33008239979,
			1199.60389717344,
			1161.70755129939,
			1118.84709428683,
			1340.46493460128,
			1283.58164016667,
			1126.40122783241,
			1196.36004322005,
			1053.19086814071,
			null,
		],
		hours_on: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		gas_lift_injection_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		bottom_hole_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		tubing_head_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		flowline_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		casing_head_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		vessel_separator_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		operational_tag: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		gasInjection: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		waterInjection: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		co2Injection: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		steamInjection: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		ngl: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		customNumber0: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		customNumber1: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		customNumber2: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		customNumber3: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		customNumber4: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
	},
	{
		_id: new ObjectId('222222222222222222222222'),
		well: new ObjectId('666666666666666666666666'),
		startIndex: 44011,
		first_production_index: 0,
		project: null,
		index: [
			44011, 44012, 44013, 44014, 44015, 44016, 44017, 44018, 44019, 44020, 44021, 44022, 44023, 44024, 44025,
			44026, 44027, 44028, 44029, 44030, 44031, 44032, 44033, 44034, 44035, 44036, 44037, 44038, 44039, 44040,
			44041,
		],
		water: [
			48.19,
			36.84,
			36.84,
			0.75,
			22.84,
			15.75,
			29.81,
			30.75,
			41.23,
			40.42,
			36.71,
			53.0200004577637,
			46.76,
			49.46,
			35.93,
			100.22,
			49.63,
			59.62,
			7.38,
			48.86,
			29.43,
			38.71,
			13.7,
			null,
			45.32,
			51.65,
			30.96,
			55.46,
			40.52,
			38.57,
			36.61,
		],
		oil: [
			56.61, 135.87, 86.98, 7.23, 74.6, 61.24, 82.63, 73.28, 89.29, 84.6, 84.88, 96.1500015258789, 57.59, 68.24,
			83.84, 100.07, 70.3, 75.84, 53.37, 56.57, 88.77, 17.27, 24.98, 48.61, 73.29, 97.61, 72.18, 68.17, 71.26,
			66.85, 63.48,
		],
		gas: [
			707.93, 656.49, 640.4, 71.4, 877.56, 757.62, 645.31, 552.74, 551.57, 616.14, 618.03, 612.830017089844,
			607.25, 547.86, 599.29, 596.01, 590.37, 588.17, 486.89, 556.95, 582.49, 342.35, 412.07, 465.42, 559.6,
			602.8, 581.17, 572.23, 565.54, 556.98, 552.19,
		],
		choke: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		hours_on: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		gas_lift_injection_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		bottom_hole_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		tubing_head_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		flowline_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		casing_head_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		operational_tag: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		vessel_separator_pressure: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		customNumber0: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			0,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		customNumber2: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			88.35,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		customNumber3: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			40,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
		gasInjection: [
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			121,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
			null,
		],
	},
];

beforeAll(async () => {
	({ db, client, mongod } = await setupDb());
});

afterAll(async () => {
	await mongod.stop();
	await client.close();
});

describe('20220503120326-fix-daily-objects-instead-of-arrays', () => {
	let dailyProductionCollection;

	beforeAll(async () => {
		dailyProductionCollection = db.collection('daily-productions');
		await dailyProductionCollection.insertMany(dailyBefore);
	});

	test('up', async () => {
		await up({ db });

		const result = await dailyProductionCollection.find({}).sort({ _id: 1 }).toArray();

		expect(result).toEqual(dailyAfter);
	});

	test('idempotency', async () => {
		await up({ db });
		await up({ db });

		const result = await dailyProductionCollection.find({}).sort({ _id: 1 }).toArray();

		expect(result).toEqual(dailyAfter);
	});
});
